[{"path":[]},{"path":"/articles/grwat.html","id":"read-raw-discharge-data","dir":"Articles","previous_headings":"","what":"Read raw discharge data","title":"Introduction to grwat R package","text":"starting point hydrograph analysis obtain source data. Let’s see goes sample spas-zagorye.txt discharge data \\(1956-2020\\) year range provided grwat. data Spas-Zagorye gauge Protva river Central European plane: grwat expects date single column. Therefore, case construct manually. convenient use make_date() function lubridate package: basic data structure grwat separation function data frame (tibble) two columns: date (first column) discharge (second column). columns can names, necessarily D Q.","code":"library(sf) # reading and manipulating spatial data library(tidyverse) # general data wrangling library(mapview) # interactive mapping of spatial data library(grwat)  mapviewOptions(fgb = FALSE)  # this is path to sample data installed with grwat path = system.file(\"extdata\", \"spas-zagorye.txt\",                     package = \"grwat\")  # for your own data just provide the full path: # path = /this/is/the/path/to/discharge/discharge.csv  hdata_raw = read_delim(path,                     col_names = c('d', 'm', 'y', 'q'),                     col_types = 'iiid', delim = ' ') # read gauge data head(hdata_raw) # see the data #> # A tibble: 6 × 4 #>       d     m     y     q #>   <int> <int> <int> <dbl> #> 1     1     1  1956  5.18 #> 2     2     1  1956  5.18 #> 3     3     1  1956  5.44 #> 4     4     1  1956  5.44 #> 5     5     1  1956  5.44 #> 6     6     1  1956  5.58 hdata = hdata_raw %>%    transmute(Date = lubridate::make_date(y, m, d),              Q = q) head(hdata) #> # A tibble: 6 × 2 #>   Date           Q #>   <date>     <dbl> #> 1 1956-01-01  5.18 #> 2 1956-01-02  5.18 #> 3 1956-01-03  5.44 #> 4 1956-01-04  5.44 #> 5 1956-01-05  5.44 #> 6 1956-01-06  5.58"},{"path":"/articles/grwat.html","id":"fill","dir":"Articles","previous_headings":"","what":"Fill gaps","title":"Introduction to grwat R package","text":"Hydrograph data may contain empty values due corrupted records missed observations specific dates. short summary gap periods can obtained gr_get_gaps() function: gr_fill_gaps() function allows filling gaps data. function first expands date sequence dates missing minimum maximum date table, trims sequence dates missing obervations beginning end sequence. expansion missing observations filled linear interpolation nearest values. can limit maximum gap extent threshold autocorrelation value (autocorr parameter) expliсit number observations (nobserv parameter): time window computed first case? autocorr parameter used, ACF (autocorrelation function) computed first, values used obtain time shift (days) autocorrelation higher equal specified value. Spas-Zagorye data time lag \\(ACF \\geq 0.7\\) 6 days, can inferred gr_plot_acf() function:","code":"gaps = gr_get_gaps(hdata) gaps #> # A tibble: 8 × 5 #>     num start_date end_date   duration   type  #>   <int> <date>     <date>     <drtn>     <chr> #> 1     1 1956-01-01 1970-04-09  5213 days data  #> 2     2 1970-04-10 1970-04-12     3 days gap   #> 3     3 1970-04-13 1979-09-09  3437 days data  #> 4     4 1979-09-10 1979-09-11     2 days gap   #> 5     5 1979-09-12 2011-05-09 11563 days data  #> 6     6 2011-05-10 2011-05-14     5 days gap   #> 7     7 2011-05-15 2020-12-26  3514 days data  #> 8     8 2020-12-27 2020-12-31     5 days gap fhdata = gr_fill_gaps(hdata, autocorr = 0.7) #> grwat: filled 10 observations using 5 days window for each variable fhdata = gr_fill_gaps(hdata, nobserv = 10) #> grwat: filled 10 observations using 10 days window for each variable gr_plot_acf(hdata, 0.5)"},{"path":"/articles/grwat.html","id":"join-meteorological-variables","dir":"Articles","previous_headings":"","what":"Join meteorological variables","title":"Introduction to grwat R package","text":"sole discharge data enough separate hydrograph quickflow baseflow, sufficient predict genesis quickflow cases. due rain thaw? answer questions also need precipitation temperature data. Ideally, must measured gauge. often data available. case need mine data external sources. One ways obtain temperature precipitation data use reanalyses ERA5. Reanalysis data arranged regular grids specific resolution. particular, ERA5 data \\(31\\) km \\(0.28125\\) degrees resolution. use data must tolerate fact none reanalysis grid nodes coincide gauge. Instead, use data, either closest reanalysis point points falling within buffer zone gauge points falling within basin gauge. points falling within buffer zone basin gauge. last two options adequate. Let’s see can done.","code":""},{"path":"/articles/grwat.html","id":"basin-buffered-basin-or-buffered-gauge","dir":"Articles","previous_headings":"Join meteorological variables","what":"Basin, buffered basin or buffered gauge","title":"Introduction to grwat R package","text":"First, need read basin spatial data: Next, can buffer data specified distance catch reanalysis data. use gr_buffer_geo function, approximates geographic buffer specified radius: Alternatively can just buffer gauge point, though less meaningful since grab reanalysis data falls gauge’s basin:","code":"# this is path to sample basin geopackage installed with grwat path = system.file(\"extdata\", \"spas-zagorye.gpkg\", package = \"grwat\")  # for your own data just provide the full path: # path = /this/is/the/path/to/discharge/basin.shp  basin = st_read(path, layer = 'basin') # read basin region #> Reading layer `basin' from data source  #>   `/private/var/folders/5s/rkxr4m8j24569d_p6nj9ld200000gn/T/Rtmpawktj1/temp_libpath649411b01a24/grwat/extdata/spas-zagorye.gpkg'  #>   using driver `GPKG' #> Simple feature collection with 1 feature and 7 fields #> Geometry type: MULTIPOLYGON #> Dimension:     XY #> Bounding box:  xmin: 35.41204 ymin: 54.88195 xmax: 36.84138 ymax: 55.57005 #> Geodetic CRS:  WGS 84 gauge = st_read(path, layer = 'gauge') # read gauge point #> Reading layer `gauge' from data source  #>   `/private/var/folders/5s/rkxr4m8j24569d_p6nj9ld200000gn/T/Rtmpawktj1/temp_libpath649411b01a24/grwat/extdata/spas-zagorye.gpkg'  #>   using driver `GPKG' #> Simple feature collection with 1 feature and 0 fields #> Geometry type: POINT #> Dimension:     XY #> Bounding box:  xmin: 36.62272 ymin: 55.03669 xmax: 36.62272 ymax: 55.03669 #> Geodetic CRS:  WGS 84 mapview(basin) + mapview(gauge) basin_buffer = gr_buffer_geo(basin, 25000)  mapview(basin_buffer, col.regions = 'red') +   mapview(basin) gauge_buffer = gr_buffer_geo(gauge, 50000)  mapview(gauge_buffer, col.regions = 'red') +   mapview(gauge)"},{"path":"/articles/grwat.html","id":"joining-the-east-european-plane-reanalysis","dir":"Articles","previous_headings":"Join meteorological variables","what":"Joining the East-European Plane reanalysis","title":"Introduction to grwat R package","text":"grwat packaged daily reanalysis covers East European territory Russia. spatial resolution \\(0.75^{\\circ} \\times 0.75^{\\circ}\\), temporal resolution \\(1\\) (one) day. Data sources include: CIRES-DOE 01-01-1880 till 31-12-1978 ERA5 01-01-1979 till now. coverage reanalysis shown :  reanalysis consists two data files, file 850 Mb size:  Download data using link using grwat. reanalysis data joined can easily plot map derived spatial configuration:","code":"rean = gr_read_rean(   '/Volumes/Data/Spatial/Reanalysis/grwat/pre_1880-2021.nc',   '/Volumes/Data/Spatial/Reanalysis/grwat/temp_1880-2021.nc' ) # read reanalysis data  fhdata_rean = gr_join_rean(fhdata, rean, basin_buffer) # join reanalysis data to hydrological series #> Joining, by = \"Date\"  head(fhdata_rean) #> # A tibble: 6 × 4 #>   Date           Q   Temp  Prec #>   <date>     <dbl>  <dbl> <dbl> #> 1 1956-01-01  5.18  -6.46 0.453 #> 2 1956-01-02  5.18 -11.4  0.825 #> 3 1956-01-03  5.44 -10.7  0.26  #> 4 1956-01-04  5.44  -8.05 0.397 #> 5 1956-01-05  5.44 -11.7  0.102 #> 6 1956-01-06  5.58 -20.1  0.032 # plot spatial configuration m = mapview(basin_buffer, col.regions = 'red') +   mapview(basin) +   mapview(rean$pts[basin_buffer, ], col.regions = 'black') +   mapview(rean$pts, cex = 1)  box = st_bbox(basin_buffer) center = st_coordinates(st_centroid(basin_buffer)) #> Warning in st_centroid.sf(basin_buffer): st_centroid assumes attributes are #> constant over geometries of x  m@map %>% leaflet::setView(center[1], center[2], zoom = 7)"},{"path":"/articles/grwat.html","id":"joining-the-era5-reanalysis","dir":"Articles","previous_headings":"Join meteorological variables","what":"Joining the ERA5 reanalysis","title":"Introduction to grwat R package","text":"described","code":""},{"path":[]},{"path":"/articles/grwat.html","id":"separate-basic","dir":"Articles","previous_headings":"","what":"Basic separation: quickflow and baseflow","title":"Introduction to grwat R package","text":"basic separation procedure provided get_baseflow() function. One commonly used approaches method Lyne-Hollick (1979):  separation mainly parameterized smoothing parameter = 0.925 default, number passes, passes = 3 default. Changing affects shape baseflow component:  Let’s see different separation methods act comparison :","code":"resbase = fhdata %>%    mutate(Qbase = gr_baseflow(Q, method = 'lynehollick'))  # quick look at the table head(resbase, 10) #> # A tibble: 10 × 3 #>    Date           Q Qbase #>    <date>     <dbl> <dbl> #>  1 1956-01-01  5.18  3.70 #>  2 1956-01-02  5.18  3.79 #>  3 1956-01-03  5.44  3.88 #>  4 1956-01-04  5.44  3.96 #>  5 1956-01-05  5.44  4.04 #>  6 1956-01-06  5.58  4.11 #>  7 1956-01-07  5.58  4.19 #>  8 1956-01-08  5.36  4.25 #>  9 1956-01-09  5.36  4.32 #> 10 1956-01-10  5.31  4.38    resbase %>%    filter(lubridate::year(Date) == 2020) %>%    ggplot() +     geom_area(aes(Date, Q), fill = 'steelblue',                color = 'black') +     geom_area(aes(Date, Qbase), fill = 'orangered',                color = 'black') #> Warning: Removed 5 rows containing missing values (position_stack). #> Removed 5 rows containing missing values (position_stack). resbase = fhdata %>%    mutate(Qbase = gr_baseflow(Q, method = 'lynehollick',                               a = 0.8, passes = 5))    resbase %>%    filter(lubridate::year(Date) == 2020) %>%    ggplot() +     geom_area(aes(Date, Q), fill = 'steelblue',                color = 'black') +     geom_area(aes(Date, Qbase), fill = 'orangered',                color = 'black') #> Warning: Removed 5 rows containing missing values (position_stack). #> Removed 5 rows containing missing values (position_stack). methods = c(\"maxwell\",             \"boughton\",             \"jakeman\",             \"lynehollick\",             \"chapman\")  plots = lapply(methods, function(m) {   resbase = fhdata %>%      mutate(Qbase = gr_baseflow(Q, method = m))    resbase %>%     filter(lubridate::year(Date) == 2020) %>%      ggplot() +       geom_area(aes(Date, Q), fill = 'steelblue', color = 'black') +       geom_area(aes(Date, Qbase), fill = 'orangered', color = 'black') +       labs(title = m) })  patchwork::wrap_plots(plots, ncol = 2) #> Warning: Removed 5 rows containing missing values (position_stack). #> Removed 5 rows containing missing values (position_stack). #> Removed 5 rows containing missing values (position_stack). #> Removed 5 rows containing missing values (position_stack). #> Removed 5 rows containing missing values (position_stack). #> Removed 5 rows containing missing values (position_stack). #> Removed 5 rows containing missing values (position_stack). #> Removed 5 rows containing missing values (position_stack). #> Removed 5 rows containing missing values (position_stack). #> Removed 5 rows containing missing values (position_stack)."},{"path":"/articles/grwat.html","id":"separate-advanced","dir":"Articles","previous_headings":"","what":"Advanced separation: genetic components","title":"Introduction to grwat R package","text":"Advanced separation aims revealing genesis quickflow. due rain snowmelting? , joint analysis discharge, temperature precipitation time series performed specialized algorithm, available gr_separate() function grwat package. genetic separation hydrograph controlled 30 parameters. names meaning parameters can learned thanks gr_help_params() function: Since number parameters large (31), organized list, fed gr_separate() function. First, get params using gr_get_params() function. parameter function reg, indicates region parameters must extracted. got parameters, can changed accessing list elements: Next, can separate hydrograph: hydrograph separated, can summarized set variables:","code":"View(gr_help_params()) # Расчленение p = gr_get_params(reg = 'Midplain') p$precdays = 5 p$ftrecdays = 85 sep = gr_separate(fhdata_rean, p) #> grwat: data frame is correct #> grwat:  parameters list and types are OK head(sep) #> # A tibble: 6 × 11 #>   Date           Q Qbase Quick Qseas Qrain Qthaw  Type  Year   Temp  Prec #>   <date>     <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <int> <int>  <dbl> <dbl> #> 1 1956-01-01  5.18    NA    NA    NA    NA    NA    NA    NA  -6.46 0.453 #> 2 1956-01-02  5.18    NA    NA    NA    NA    NA    NA    NA -11.4  0.825 #> 3 1956-01-03  5.44    NA    NA    NA    NA    NA    NA    NA -10.7  0.26  #> 4 1956-01-04  5.44    NA    NA    NA    NA    NA    NA    NA  -8.05 0.397 #> 5 1956-01-05  5.44    NA    NA    NA    NA    NA    NA    NA -11.7  0.102 #> 6 1956-01-06  5.58    NA    NA    NA    NA    NA    NA    NA -20.1  0.032 vars = gr_summarize(sep) head(vars) #> # A tibble: 6 × 57 #>    Year Year1 Year2 datestart  datepolend PolProd    Qy  Qmax datemax     Qygr #>   <int> <int> <dbl> <date>     <date>       <int> <dbl> <dbl> <date>     <dbl> #> 1  1956  1956  1957 1956-04-14 1956-05-05      21  18.5   467 1956-04-22  8.44 #> 2  1957  1957  1958 1957-03-28 1957-05-22      55  20.3   460 1957-04-08  9.34 #> 3  1958  1958  1959 1958-04-04 1958-05-16      42  27.4   537 1958-04-21  9.90 #> 4  1959  1959  1960 1959-03-28 1959-04-27      30  27.1   406 1959-04-16 10.6  #> 5  1960  1960  1961 1960-03-27 1960-04-26      30  29.4   406 1960-04-15 12.0  #> 6  1961  1961  1962 1961-03-11 1961-05-06      56  18.7   296 1961-04-10 10.5  #> # … with 47 more variables: Qmmsummer <dbl>, monmmsummer <date>, Qmmwin <dbl>, #> #   nommwin <date>, Q30s <dbl>, date30s1 <date>, date30s2 <date>, Q30w <dbl>, #> #   date30w1 <date>, date30w2 <date>, Q10s <dbl>, date10s1 <date>, #> #   date10s2 <date>, Q10w <dbl>, date10w1 <date>, date10w2 <date>, Q5s <dbl>, #> #   date5s1 <date>, date5s2 <date>, Q5w <dbl>, date5w1 <date>, date5w2 <date>, #> #   Wy <dbl>, Wgr <dbl>, Wpol2 <dbl>, Wpol1 <dbl>, Wpol3 <dbl>, Wpavs2 <dbl>, #> #   Wpavs1 <dbl>, Wpavthaw2 <dbl>, Wpavthaw1 <dbl>, WgrS <dbl>, WS <dbl>, …"},{"path":"/articles/grwat.html","id":"plot-and-test","dir":"Articles","previous_headings":"","what":"Plot and test","title":"Introduction to grwat R package","text":"functions grwat package allow : Plot separation hydrograph Plot interannual changes key water discharge variables Plot long-term changes key water discharge variables Perform statistical tests calculated variables Graphical functions based ggplot2 graphics.","code":""},{"path":"/articles/grwat.html","id":"plot-separation-of-hydrograph","dir":"Articles","previous_headings":"","what":"Plot separation of hydrograph","title":"Introduction to grwat R package","text":"can plot separations selected years using gr_plot_sep() function:    also multiple years layout:","code":"gr_plot_sep(sep, 1976) # plot single year #> Warning: Removed 1 rows containing missing values (position_stack). gr_plot_sep(sep, c(2016, 2017)) # plot two years sequentially #> Warning: Removed 1 rows containing missing values (position_stack). gr_plot_sep(sep, 1976:1979, # plot four years on the same page             layout = matrix(c(1,2,3,4), ncol=2, byrow = T)) #> Warning: Removed 1 rows containing missing values (position_stack). #> Removed 1 rows containing missing values (position_stack). #> Removed 1 rows containing missing values (position_stack). #> Warning: Removed 2 rows containing missing values (position_stack)."},{"path":"/articles/grwat.html","id":"interannual-change-variables","dir":"Articles","previous_headings":"","what":"Interannual change variables","title":"Introduction to grwat R package","text":"get detailed description available variables can invoke gr_help_vars(): Parameters can statistically tested using test_variables(df, ..., year = NULL, locale='EN') function. Names parameters passed comma-separated place .... quoted, need pass character strings, just write names: example three variables selected: want test parameters, just skip variable names: Long-term changes tested breaking year, calculated variable using Pettitt test. However, want use fixed year, pass desired breaking year change_year parameter:","code":"View(gr_help_vars()) gr_test_vars(vars, Qmax) #> Warning: `select_()` was deprecated in dplyr 0.7.0. #> Please use `select()` instead. #> This warning is displayed once every 8 hours. #> Call `lifecycle::last_lifecycle_warnings()` to see where this warning was generated. #> $ptt #> $ptt$Qmax #>  #>  Pettitt's test for single change-point detection #>  #> data:  vl[vl_cmp] #> U* = 438, p-value = 0.01362 #> alternative hypothesis: two.sided #> sample estimates: #> probable change point at time K  #>                              15  #>  #>  #>  #> $mkt #> $mkt$Qmax #>  #>  Mann-Kendall trend test #>  #> data:  vl[vl_cmp] #> z = -3.5226, n = 61, p-value = 0.0004273 #> alternative hypothesis: true S is not equal to 0 #> sample estimates: #>             S          varS           tau  #>  -567.0000000 25816.3333333    -0.3104304  #>  #>  #>  #> $tst #> $tst$Qmax #>  #>  Sen's slope #>  #> data:  df.theil[[2]][fltr] #> z = -3.5226, n = 61, p-value = 0.0004273 #> alternative hypothesis: true z is not equal to 0 #> 95 percent confidence interval: #>  -5.842308 -1.833333 #> sample estimates: #> Sen's slope  #>   -4.035897  #>  #>  #>  #> $ts_fit #> $ts_fit$Qmax #>  #> Call: #> mblm::mblm(formula = eval(frml), dataframe = df.theil[fltr, ],  #>     repeated = FALSE) #>  #> Coefficients: #> (Intercept)        Year1   #>    7881.673       -3.832   #>  #>  #>  #> $tt #> $tt$Qmax #>  #>  Welch Two Sample t-test #>  #> data:  d1 and d2 #> t = 3.4769, df = 19.509, p-value = 0.002448 #> alternative hypothesis: true difference in means is not equal to 0 #> 95 percent confidence interval: #>   67.13907 269.33024 #> sample estimates: #> mean of x mean of y  #>  419.7857  251.5511  #>  #>  #>  #> $ft #> $ft$Qmax #>  #>  F test to compare two variances #>  #> data:  d1 and d2 #> F = 1.2702, num df = 13, denom df = 46, p-value = 0.5301 #> alternative hypothesis: true ratio of variances is not equal to 1 #> 95 percent confidence interval: #>  0.577135 3.501424 #> sample estimates: #> ratio of variances  #>           1.270152  #>  #>  #>  #> $year #> Qmax  #> 1970  #>  #> $maxval #> $maxval$Qmax #> [1] 780 #>  #>  #> $fixed_year #> [1] FALSE #>  #> $pvalues #>   N                                            Variable Change.Year    Trend #> 1 1 Maximum annual discharge during seasonal flood wave        1970 -3.83177 #>         M1       M2 MeanRatio      sd1      sd2 sdRatio Mann.Kendall Pettitt #> 1 419.7857 251.5511     -40.1 162.9446 144.5813   -11.3      0.00043 0.01362 #>   Student  Fisher #> 1 0.00245 0.53009 tests = gr_test_vars(vars, Qygr, date10w1, Wpol3) tests$pvalues #>   N                                                              Variable #> 1 1 Annual groundwater discharge (\"baseflow\") during water-resources year #> 2 2                   First date of 10-day window discharge during winter #> 3 3                Seasonal flood runoff (with groundwater and rainwater) #>   Change.Year    Trend       M1       M2 MeanRatio      sd1      sd2 sdRatio #> 1        1979  0.09258   9.1199 13.96511      53.1  1.92240  2.43835    26.8 #> 2        1987 -0.25000   29-Jan   15-Jan     -14.0 31.00000 33.00000     6.5 #> 3        1988 -0.08643 12.29213  8.61417     -29.9  5.67057  4.20458   -25.9 #>   Mann.Kendall Pettitt Student  Fisher #> 1      0.00002 0.00000 0.00000 0.25633 #> 2      0.36675 0.52982 0.11576 0.70911 #> 3      0.00429 0.01491 0.00587 0.10877 tests = gr_test_vars(vars) tests$year # this is a change year detected for each variable #>             Wy          Wpol2            Wgr          Wpol1         Wpavs2  #>           1978           1988           1978           1988           1972  #>         Wpavs1      Wpavthaw2      Wpavthaw1           WgrW             WW  #>           1972           1983           1972           1978           1978  #>           WgrS             WS             Qy      datestart           Qygr  #>           1977           1972           1978           1972           1979  #>     datepolend        PolProd           Qmax        datemax          Wpol3  #>           1970           1988           1970           1970           1988  #>         Qmmwin        nommwin      Qmmsummer    monmmsummer           Q30w  #>           1979           1965           1979           2000           1979  #>       date30w1           Q30s       date30s1           Q10w       date10w1  #>           2001           1979           2000           1979           1987  #>           Q10s       date10s1            Q5w        date5w1            Q5s  #>           1981           2000           1979           1987           1981  #>        date5s1    Qmaxpavthaw datemaxpavthaw     CountThaws    DaysThawWin  #>           2000           2004           1995           1995           1984  #>       Qmaxpavs    datemaxpavs      CountPavs    DaysPavsSum          CvWin  #>           1977           2002           1977           1968           1983  #>        WinProd          CvSum        SumProd  #>           1968           1970           1968 tests = gr_test_vars(vars, Qmax, Qygr, change_year = 1987) tests$ft # Fisher F tests to compare two variances #> $Qmax #>  #>  F test to compare two variances #>  #> data:  d1 and d2 #> F = 1.2702, num df = 13, denom df = 46, p-value = 0.5301 #> alternative hypothesis: true ratio of variances is not equal to 1 #> 95 percent confidence interval: #>  0.577135 3.501424 #> sample estimates: #> ratio of variances  #>           1.270152  #>  #>  #> $Qygr #>  #>  F test to compare two variances #>  #> data:  d1 and d2 #> F = 0.62158, num df = 20, denom df = 39, p-value = 0.2563 #> alternative hypothesis: true ratio of variances is not equal to 1 #> 95 percent confidence interval: #>  0.2992153 1.4247366 #> sample estimates: #> ratio of variances  #>          0.6215787"},{"path":"/articles/grwat.html","id":"plot-interannual-changes","dir":"Articles","previous_headings":"","what":"Plot interannual changes","title":"Introduction to grwat R package","text":"Interannual changes visualized using gr_plot_vars() function. syntax similar gr_test_vars() gr_plot_sep():     can add results statistical tests plot specifying tests = TRUE function call. case subtitle test results added, Theil-Sen slope Pettitt test breaking year drawn solid (\\(p \\leq 0.05\\)) dashed (\\(p > 0.05\\)) lines:   Alternatively, can pass tests result test_variables(), need precompute specific parameters (example, setting exclude year: Beware case test variables order used plotting. plot variables , B, C supply tests variables X, Y, Z, added without warnings, responsibility keep correspondence . Finally, can plot variables supplying column names plot_variables() function. case tests (want plot ) also calculated variables:","code":"gr_plot_vars(vars, Qmax) # plot one selected variable gr_plot_vars(vars, datestart) # plot one selected variable gr_plot_vars(vars, date10w1, Wpol3) # plot two variables sequentially gr_plot_vars(vars, Qmax, Qygr, date10w1, Wpol3, # plot four variables in matrix layout              layout = matrix(c(1,2,3,4), nrow=2, byrow=TRUE)) gr_plot_vars(vars, date10w1, Wpol3, DaysThawWin, Qmaxpavs,              tests = TRUE) # add test information #> Warning: Removed 3 rows containing non-finite values (stat_smooth). #> Warning: Removed 1 row(s) containing missing values (geom_path). #> Warning: Removed 3 rows containing missing values (geom_rect). gr_plot_vars(vars, date10w1, Wpol3, DaysThawWin, Qmaxpavs,              tests = gr_test_vars(vars, date10w1, Wpol3, DaysThawWin, Qmaxpavs, exclude = 1990)) # add test information gr_plot_vars(vars, tests = TRUE)"},{"path":"/articles/grwat.html","id":"plot-long-term-period-changes","dir":"Articles","previous_headings":"","what":"Plot long-term period changes","title":"Introduction to grwat R package","text":"Long-term changes differences summarized statistics one variable calculated two selected periods. statistics reflect differences distributions parameters, grwat visualizes box plots using gr_plot_periods() function. syntax similar gr_plot_vars() except must provide either tests year parameter. supplied tests prioritized (can also supply fixed year testing variables:    Multiple plots can combined one page using layout parameter:  plot long-term changes variables just skip variable names function call: also small helper function plots histogram minimal discharge month summer winter periods:","code":"gr_plot_periods(vars, Qy, year = 1978) gr_plot_periods(vars, Qy, tests = TRUE) gr_plot_periods(vars, Qy, tests = gr_test_vars(vars, Qy, year = 1985)) gr_plot_periods(vars, Qy, Qmax, date10w1, Wpol3,                 tests = TRUE,                 layout = matrix(1:4, nrow = 2)) gr_plot_periods(vars, tests = TRUE) gr_plot_minmonth(vars, year = 1985)"},{"path":"/articles/grwat.html","id":"plot-discharge-parameters","dir":"Articles","previous_headings":"","what":"Plot discharge parameters","title":"Introduction to grwat R package","text":"dedicated gr_plot_matrix() function plot whole time series convenient matrix form. Currently supports plotting value, seasons components discharge:    can also limit range years plotted:","code":"gr_plot_matrix(sep, type = 'value') #> Warning: Removed 147 rows containing missing values (geom_raster). gr_plot_matrix(sep, type = 'season') #> Warning: Removed 147 rows containing missing values (geom_raster). gr_plot_matrix(sep, type = 'component') #> Warning: Removed 147 rows containing missing values (geom_raster). gr_plot_matrix(sep, years = 1980:1995, type = 'component') #> Warning: Removed 36 rows containing missing values (geom_raster)."},{"path":"/articles/grwat.html","id":"hydrograph-comparisons","dir":"Articles","previous_headings":"","what":"Hydrograph comparisons","title":"Introduction to grwat R package","text":"Sometimes want compare hydrographs selected years. multiple ways R. explore three : overlayed, ridgeline horiaon plots. Since require small number manipulations via existing R packages, dedicated functionality grwat.","code":""},{"path":"/articles/grwat.html","id":"overlayed","dir":"Articles","previous_headings":"","what":"Overlayed","title":"Introduction to grwat R package","text":"simplest (necessarily effective) way compare multiple hydrographs just combine one plot:  can seen even case two hydrographs plot easy read. becomes nearly impossible increase number years:","code":"library(ggplot2) library(lubridate) #>  #> Attaching package: 'lubridate' #> The following objects are masked from 'package:base': #>  #>     date, intersect, setdiff, union  sep_sel = sep |>    filter(Year %in% c(1989, 2012))  ggplot(sep_sel, aes(ymd(20000101) + yday(Date), Q,                      fill = factor(Year), group = factor(Year))) +    geom_area(alpha = 0.8, position = \"identity\") +   geom_line() +   scale_x_date(date_labels = \"%b\", date_breaks = \"1 month\") +   theme_minimal() +   labs(x = 'Date', y = 'Discharge', fill = 'Year') sep_sel = sep |>    filter(Year %in% c(1960, 1965, 1989, 2001, 2012))  ggplot(sep_sel, aes(ymd(20000101) + yday(Date), Q,                      fill = factor(Year), group = factor(Year))) +    geom_area(alpha = 0.8, position = \"identity\") +   geom_line() +   scale_x_date(date_labels = \"%b\", date_breaks = \"1 month\") +   theme_minimal() +   labs(x = 'Date', y = 'Year')"},{"path":"/articles/grwat.html","id":"ridgeline","dir":"Articles","previous_headings":"","what":"Ridgeline","title":"Introduction to grwat R package","text":"interested shape relative dimensions hydrographs, want exact Y axis, can proceed ridgeline plots available ggridges package. grwat contains convenient wrapper called gr_plot_ridge():","code":"gr_plot_ridge(sep, years = c(1960, 1965, 1989, 2001, 2012))"},{"path":"/articles/grwat.html","id":"horizon","dir":"Articles","previous_headings":"","what":"Horizon","title":"Introduction to grwat R package","text":"Another alternative ridgeline plot horizon plot, can built ggHoriPlot package. Horizon plots compact allow viewing hydrographs . grwat contains convenient wrapper called gr_plot_hori():","code":"gr_plot_hori(sep, years = 1960:1980)"},{"path":"/articles/grwat.html","id":"reports","dir":"Articles","previous_headings":"","what":"Reports","title":"Introduction to grwat R package","text":"render HTML report just pass separation variables gr_report() function, provide output file name: See report generated command.","code":"report = paste(getwd(), 'Spas-Zagorye.html', sep = '/') gr_report(sep, vars, output = report) browseURL(report)"},{"path":"/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Timofey Samsonov. Author, maintainer. Ekaterina Retz. Contributor. Maria Kireeva. Contributor.","code":""},{"path":"/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Samsonov T (2022). grwat: Hydrograph separation analysis. R package version 0.0.0.9000, https://github.com/tsamsonov/grwat.","code":"@Manual{,   title = {grwat: Hydrograph separation and analysis},   author = {Timofey Samsonov},   year = {2022},   note = {R package version 0.0.0.9000},   url = {https://github.com/tsamsonov/grwat}, }"},{"path":"/index.html","id":"grwat","dir":"","previous_headings":"","what":"Hydrograph separation and analysis","title":"Hydrograph separation and analysis","text":"Welcome grwat, R package package automatic hydrograph separation hydrological time series analysis. High-performance C++17 computation used hydrograph processing separates runoff ground, seasonal, thaw, flood runoff. Interannual long-term characteristics runoff type derived. Results visualized form high-quality reports making use ggplot2 graphics knitr report generation.","code":""},{"path":"/index.html","id":"installing","dir":"","previous_headings":"","what":"Installing","title":"Hydrograph separation and analysis","text":"grwat available CRAN yet. can install GitHub repository. three steps required: Install devtools R package Install compiler (Windows macOS ) Install grwat R package","code":""},{"path":"/index.html","id":"install-devtools","dir":"","previous_headings":"Installing","what":"Install devtools","title":"Hydrograph separation and analysis","text":"install GitHub, install devtools package first (unless already installed machine):","code":"install.packages(\"devtools\")"},{"path":"/index.html","id":"install-compiler","dir":"","previous_headings":"Installing","what":"Install compiler","title":"Hydrograph separation and analysis","text":"Since grwat contains C++ code, needs compiled package installation. Linux users compiler already installed system. macOS users : Install Xcode command-line tools. Restart R session. Windows users : Install Rtools. Restart R session.","code":""},{"path":"/index.html","id":"install-grwat","dir":"","previous_headings":"Installing","what":"Install grwat","title":"Hydrograph separation and analysis","text":"previous steps completed successfully, grwat package can installed via single command: note Windows users: get error installation previously installed grwat, remove package folder manually, restart R hit devtools::install_github(\"tsamsonov/grwat\", INSTALL_opts = '---lock'). run RStudio Administrator get full access package installation folder. location installation folder can learned Packages — Install dialog .libPaths() command R console displayed .","code":"devtools::install_github(\"tsamsonov/grwat\") > .libPaths() [1] \"C:/Users/tsamsonov/Documents/R/win-library/4.1\" [2] \"C:/Program Files/R/R-4.1.0/library\""},{"path":"/index.html","id":"funding","dir":"","previous_headings":"","what":"Funding","title":"Hydrograph separation and analysis","text":"grwat package developed financial support Russian Science Foundation (Project 19-77-10032). main separation algoritm developed 2016-2018 financial support RFBR (Project 16-35-60080). mountain block main separation algoritm developed 2018-2019 financial support Russian Science Foundation (Project 17-77-10169).","code":""},{"path":"/reference/gr_animate.html","id":null,"dir":"Reference","previous_headings":"","what":"Animate hydrograph — gr_animate","title":"Animate hydrograph — gr_animate","text":"convenient wrapper around gganimate::animate() animate river hydrograph years.","code":""},{"path":"/reference/gr_animate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Animate hydrograph — gr_animate","text":"","code":"gr_animate(   df,   plot = TRUE,   file = NULL,   fps = 20,   kframes = 10,   width = 800,   height = 600,   locale = \"EN\" )"},{"path":"/reference/gr_animate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Animate hydrograph — gr_animate","text":"df data.frame date (1st) discharge (2nd) columns. plot Boolean. Plot animation viewer? Defaults TRUE. file Character string path output file. fps Integer value frames per second. Defaults 20. kframes Integer value setting many frames interpolated year. Defaults 10, means fps = 20, two years passed second. width Integer width animation (pixels). Defaults 800. height Integer height animation (pixels). Defaults 600 locale Character string locale. Currently English locale supported. Defaults 'EN'.","code":""},{"path":"/reference/gr_animate.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Animate hydrograph — gr_animate","text":"return value gganimate::renderer() function","code":""},{"path":"/reference/gr_baseflow.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract baseflow — gr_baseflow","title":"Extract baseflow — gr_baseflow","text":"Extract baseflow hydrological series using filtering approach","code":""},{"path":"/reference/gr_baseflow.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract baseflow — gr_baseflow","text":"","code":"gr_baseflow(   Q,   a = 0.925,   k = 0.975,   C = 0.05,   aq = -0.5,   passes = 3,   padding = 30,   method = \"lynehollick\" )"},{"path":"/reference/gr_baseflow.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract baseflow — gr_baseflow","text":"Q Numeric runoff vector. Numeric value filtering parameter used 'chapman', 'jakeman' 'lynehollick' methods. Defaults 0.925. k Numeric value filtering parameter used 'boughton' 'maxwell' methods. Defaults 0.975. C Numeric value separation shape parameter used 'boughton', 'jakeman' 'maxwell' methods aq Numeric value filtering parameter used 'jakeman' method. Defaults -0.5. passes Integer number filtering iterations. first iteration forward, second backward, third forward . Defaults 3. padding Integer number elements padded beginning ending runoff vector reduce boundary effects. Defaults 30. method Character string set baseflow filtering method. Available methods 'boughton', 'chapman', 'furey', 'jakeman', 'kudelin' ('coodelin' like!), 'lynehollick' 'maxwell'. Default 'lynehollick', corresponds Lyne-Hollick (1979) hydrograph separation method.","code":""},{"path":"/reference/gr_baseflow.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract baseflow — gr_baseflow","text":"Numeric baseflow vector","code":""},{"path":"/reference/gr_buffer_geo.html","id":null,"dir":"Reference","previous_headings":"","what":"Quasi-geographic buffering — gr_buffer_geo","title":"Quasi-geographic buffering — gr_buffer_geo","text":"Generate buffer spatial object geographic coordinates. function transforms object Azimuthal equidistant projection, buffers specified radius reprojects geographical coordinate system (WGS84)","code":""},{"path":"/reference/gr_buffer_geo.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Quasi-geographic buffering — gr_buffer_geo","text":"","code":"gr_buffer_geo(g, bufsize)"},{"path":"/reference/gr_buffer_geo.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Quasi-geographic buffering — gr_buffer_geo","text":"g sf sfg object known coordinate system. bufsize Numeric value buffer distance, meters.","code":""},{"path":"/reference/gr_buffer_geo.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Quasi-geographic buffering — gr_buffer_geo","text":"sf sfg object, buffered bufsize projected geographic coordinates (WGS84).","code":""},{"path":"/reference/gr_check_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Check the correctness of data frame for separating — gr_check_data","title":"Check the correctness of data frame for separating — gr_check_data","text":"Check correctness data frame separating","code":""},{"path":"/reference/gr_check_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check the correctness of data frame for separating — gr_check_data","text":"","code":"gr_check_data(df)"},{"path":"/reference/gr_check_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check the correctness of data frame for separating — gr_check_data","text":"df data.frame four columns: date, discharge, temperature, precipitation.","code":""},{"path":"/reference/gr_check_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check the correctness of data frame for separating — gr_check_data","text":"stops execution df contains wrong number columns, columns wrong types, data columns incorrect (e.g. discharge precipitation negative).","code":""},{"path":[]},{"path":"/reference/gr_check_params.html","id":null,"dir":"Reference","previous_headings":"","what":"Check the correctness of parameters list for separating — gr_check_params","title":"Check the correctness of parameters list for separating — gr_check_params","text":"Check correctness parameters list separating","code":""},{"path":"/reference/gr_check_params.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check the correctness of parameters list for separating — gr_check_params","text":"","code":"gr_check_params(df, params)"},{"path":"/reference/gr_check_params.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check the correctness of parameters list for separating — gr_check_params","text":"df data.frame four columns: date, discharge, temperature, precipitation params list separation parameters, returned gr_get_params() function","code":""},{"path":"/reference/gr_check_params.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check the correctness of parameters list for separating — gr_check_params","text":"stops execution anything wrong prints exact reason error. Otherwise prints message everything OK","code":""},{"path":"/reference/gr_fill_gaps.html","id":null,"dir":"Reference","previous_headings":"","what":"Fill missing runoff data — gr_fill_gaps","title":"Fill missing runoff data — gr_fill_gaps","text":"Use function fill missing runoff data linear interpolation. can missing dates missing runoff values. preliminary summary missing data can viewed gr_get_gaps()","code":""},{"path":"/reference/gr_fill_gaps.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fill missing runoff data — gr_fill_gaps","text":"","code":"gr_fill_gaps(hdata, autocorr = 0.7, nobserv = NULL)"},{"path":"/reference/gr_fill_gaps.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fill missing runoff data — gr_fill_gaps","text":"hdata data.frame two columns, first column Date, second column numeric runoff value. autocorr Autocorrelation value defines possible length period can filled. Defaults 0.7.  nobserv parameter set, parameter ignored. parameters NULL, gaps filled disregard lengths (recommended). nobserv Maximum number contiguous observations can interpolated. Defaults NULL. parameter set, autocorr parameter ignored. parameters NULL, gaps filled disregard lengths (recommended).","code":""},{"path":"/reference/gr_fill_gaps.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fill missing runoff data — gr_fill_gaps","text":"data.frame filled version hdata","code":""},{"path":"/reference/gr_get_gaps.html","id":null,"dir":"Reference","previous_headings":"","what":"Get gaps in the runoff data — gr_get_gaps","title":"Get gaps in the runoff data — gr_get_gaps","text":"Use function detect periods missing data. can missing dates missing runoff values","code":""},{"path":"/reference/gr_get_gaps.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get gaps in the runoff data — gr_get_gaps","text":"","code":"gr_get_gaps(hdata)"},{"path":"/reference/gr_get_gaps.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get gaps in the runoff data — gr_get_gaps","text":"hdata data.frame two columns, first column Date, second column numeric runoff value","code":""},{"path":"/reference/gr_get_gaps.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get gaps in the runoff data — gr_get_gaps","text":"data.frame periods data periods gaps","code":""},{"path":"/reference/gr_get_params.html","id":null,"dir":"Reference","previous_headings":"","what":"Get separation parameters for specified location — gr_get_params","title":"Get separation parameters for specified location — gr_get_params","text":"Location can identified region name geographic coordinates. specified, region higher priority","code":""},{"path":"/reference/gr_get_params.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get separation parameters for specified location — gr_get_params","text":"","code":"gr_get_params(reg = \"Midplain\", lon = NULL, lat = NULL)"},{"path":"/reference/gr_get_params.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get separation parameters for specified location — gr_get_params","text":"reg Character string — name region. Defaults 'Midplain'. lon Numeric value longitude. lat Numeric value latitude.","code":""},{"path":"/reference/gr_get_params.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get separation parameters for specified location — gr_get_params","text":"List separation parameters can used gr_separate()  function.","code":""},{"path":"/reference/gr_help_params.html","id":null,"dir":"Reference","previous_headings":"","what":"Get the information about parameters used to separate the hydrograph — gr_help_params","title":"Get the information about parameters used to separate the hydrograph — gr_help_params","text":"Get information parameters used separate hydrograph","code":""},{"path":"/reference/gr_help_params.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get the information about parameters used to separate the hydrograph — gr_help_params","text":"","code":"gr_help_params()"},{"path":"/reference/gr_help_params.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get the information about parameters used to separate the hydrograph — gr_help_params","text":"data.frame description hydrograph separation parameters used gr_separate() .","code":""},{"path":"/reference/gr_help_vars.html","id":null,"dir":"Reference","previous_headings":"","what":"Hydrograph separation variables — gr_help_vars","title":"Hydrograph separation variables — gr_help_vars","text":"Use function learn meaning variables calculated gr_summarize().","code":""},{"path":"/reference/gr_help_vars.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Hydrograph separation variables — gr_help_vars","text":"","code":"gr_help_vars()"},{"path":"/reference/gr_help_vars.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Hydrograph separation variables — gr_help_vars","text":"data.frame hydrograph separation variables","code":""},{"path":"/reference/gr_join_rean.html","id":null,"dir":"Reference","previous_headings":"","what":"Join reanalysis data — gr_join_rean","title":"Join reanalysis data — gr_join_rean","text":"function performs spatial join meteorological variables (temperature precipitation) grwat reanalysis daily runoff time series. Reanalysis covers East European Plain 0.75 degrees spatial resolution obtained based CIRES-DOE (1880-1949) ERA5 (1950-2021) data. function useful data meteorological stations missing inside basin.","code":""},{"path":"/reference/gr_join_rean.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Join reanalysis data — gr_join_rean","text":"","code":"gr_join_rean(hdata, rean, buffer)"},{"path":"/reference/gr_join_rean.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Join reanalysis data — gr_join_rean","text":"hdata data.frame containing 2 columns: Date runoff rean list returned gr_read_rean() buffer sf object containing region select reanalysis data. Usually river basin used select meteorological data. Use gr_buffer_geo() buffer basin specified distance get data, needed.","code":""},{"path":"/reference/gr_join_rean.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Join reanalysis data — gr_join_rean","text":"data.frame four columns: date, runoff, temperature, precipitation.","code":""},{"path":"/reference/gr_join_rean.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Join reanalysis data — gr_join_rean","text":"Download reanalysis archive http://carto.geogr.msu.ru/grwat/.","code":""},{"path":"/reference/gr_kable_tests.html","id":null,"dir":"Reference","previous_headings":"","what":"Tabular representation of tests — gr_kable_tests","title":"Tabular representation of tests — gr_kable_tests","text":"function used represent results gr_test_vars() tabular form. Used mainly gr_report(), can used purposes.","code":""},{"path":"/reference/gr_kable_tests.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Tabular representation of tests — gr_kable_tests","text":"","code":"gr_kable_tests(tests, format = \"html\", locale = \"EN\")"},{"path":"/reference/gr_kable_tests.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Tabular representation of tests — gr_kable_tests","text":"tests list tests returned gr_test_vars() function. format Character string encoding type output. Currently 'html' supported. locale Character string locale. Currently English locale supported. Defaults 'EN'.","code":""},{"path":"/reference/gr_kable_tests.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Tabular representation of tests — gr_kable_tests","text":"HTML table returned knitr::kable() function.","code":""},{"path":"/reference/gr_mamba.html","id":null,"dir":"Reference","previous_headings":"","what":"Just mamba — gr_mamba","title":"Just mamba — gr_mamba","text":"Just mamba","code":""},{"path":"/reference/gr_mamba.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Just mamba — gr_mamba","text":"","code":"gr_mamba()"},{"path":"/reference/gr_mamba.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Just mamba — gr_mamba","text":"mamba","code":""},{"path":"/reference/gr_mamba.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Just mamba — gr_mamba","text":"","code":"gr_mamba()"},{"path":"/reference/gr_plot_acf.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot runoff ACF — gr_plot_acf","title":"Plot runoff ACF — gr_plot_acf","text":"function plots autocorrelation function (ACF) daily runoff time series. number days corresponding specified autocorr value highlighted.","code":""},{"path":"/reference/gr_plot_acf.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot runoff ACF — gr_plot_acf","text":"","code":"gr_plot_acf(hdata, autocorr = 0.7, maxlag = 30)"},{"path":"/reference/gr_plot_acf.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot runoff ACF — gr_plot_acf","text":"hdata data.frame two columns: date runoff. autocorr Numeric value autocorrelation time period highlighted. Defaults 0.7. maxlag Integer value maximum daily lag used calculate correlation. Defaults 30.","code":""},{"path":"/reference/gr_plot_hori.html","id":null,"dir":"Reference","previous_headings":"","what":"Horizon hydrograph plot — gr_plot_hori","title":"Horizon hydrograph plot — gr_plot_hori","text":"convenient wrapper around ggHoriPlot::geom_horizon() visualize multiple river hydrographs .","code":""},{"path":"/reference/gr_plot_hori.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Horizon hydrograph plot — gr_plot_hori","text":"","code":"gr_plot_hori(df, years, pal = \"Blues\", rev = T, scale = 6, locale = \"EN\")"},{"path":"/reference/gr_plot_hori.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Horizon hydrograph plot — gr_plot_hori","text":"df data.frame date (1st) discharge (2nd) columns. years Integer vector years plotted. pal Numeric character string. Color palette identifier passed ggplot2::scale_fill_distiller(). rev Boolean. Reverse palette? Defaults FALSE. scale Numeric scale factor passed ggHoriPlot::geom_horizon(). Defaults 0.01. locale Character string locale. Currently English locale supported. Defaults 'EN'.","code":""},{"path":"/reference/gr_plot_hori.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Horizon hydrograph plot — gr_plot_hori","text":"ggplot2 object","code":""},{"path":"/reference/gr_plot_matrix.html","id":null,"dir":"Reference","previous_headings":"","what":"Runoff matrix plot — gr_plot_matrix","title":"Runoff matrix plot — gr_plot_matrix","text":"function plots runoff values, components seasons using matrix-based approach. X axis corresponds day year, Y axis corresponds year. function useful whole picture river runoff needs assessed.","code":""},{"path":"/reference/gr_plot_matrix.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Runoff matrix plot — gr_plot_matrix","text":"","code":"gr_plot_matrix(df, years = NULL, type = \"value\", locale = \"EN\")"},{"path":"/reference/gr_plot_matrix.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Runoff matrix plot — gr_plot_matrix","text":"df data.frame hydrograph separation produced gr_separate(). years Integer vector years plotted. Defaults NULL. type Character string. Supported options 'value', 'components', 'season'. Defaults 'value'. locale Character string locale. Currently English locale supported. Defaults 'EN'.","code":""},{"path":"/reference/gr_plot_minmonth.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot minimum discharge month — gr_plot_minmonth","title":"Plot minimum discharge month — gr_plot_minmonth","text":"Generate histogram minimum discharge month two periods: change year set year parameter.","code":""},{"path":"/reference/gr_plot_minmonth.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot minimum discharge month — gr_plot_minmonth","text":"","code":"gr_plot_minmonth(   df,   year = NULL,   exclude = NULL,   tests = NULL,   pagebreak = FALSE,   locale = \"EN\" )"},{"path":"/reference/gr_plot_minmonth.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot minimum discharge month — gr_plot_minmonth","text":"df data.frame hydrograph meteorological variables produced gr_summarize(). year Integer. Change year value separate two periods. exclude Integer vector years excluded plotting. locale Character string locale. Currently English locale supported. Defaults 'EN'.","code":""},{"path":"/reference/gr_plot_periods.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot long-term hydrograph variable changes — gr_plot_periods","title":"Plot long-term hydrograph variable changes — gr_plot_periods","text":"function generates boxplots hydrograph separation variables produced gr_summarize(). data variable divided two samples: change year either set year parameter extracted tests (statistically estimated). Different background fill colors used differentiate seasons types.","code":""},{"path":"/reference/gr_plot_periods.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot long-term hydrograph variable changes — gr_plot_periods","text":"","code":"gr_plot_periods(   df,   ...,   year = NULL,   exclude = NULL,   tests = NULL,   layout = as.matrix(1),   pagebreak = FALSE,   locale = \"EN\" )"},{"path":"/reference/gr_plot_periods.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot long-term hydrograph variable changes — gr_plot_periods","text":"df data.frame hydrograph meteorological variables produced gr_summarize(). ... Quoted sequence variable names. year Integer. Change year value separate two periods (overridden tests supplied). exclude Integer vector years excluded plotting. tests Tests list variables (generated test_variables() function) layout matrix encodes order plotting. pagebreak Logical. Whether break page plots (needed reporting). Defaults FALSE. locale Character string locale. Currently English locale supported. Defaults 'EN'.","code":""},{"path":"/reference/gr_plot_ridge.html","id":null,"dir":"Reference","previous_headings":"","what":"Ridgeline hydrograph plot — gr_plot_ridge","title":"Ridgeline hydrograph plot — gr_plot_ridge","text":"convenient wrapper around ggridges::geom_ridgeline() visualize multiple river hydrographs .","code":""},{"path":"/reference/gr_plot_ridge.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Ridgeline hydrograph plot — gr_plot_ridge","text":"","code":"gr_plot_ridge(   df,   years,   pal = 4,   rev = FALSE,   scale = 0.01,   alpha = 0.8,   locale = \"EN\" )"},{"path":"/reference/gr_plot_ridge.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Ridgeline hydrograph plot — gr_plot_ridge","text":"df data.frame date (1st) discharge (2nd) columns. years Integer vector years plotted. pal Numeric character string. Color palette identifier passed ggplot2::scale_fill_distiller(). rev Boolean. Reverse palette? Defaults FALSE. scale Numeric scale factor passed ggridges::geom_ridgeline(). Defaults 0.01. alpha Numeric opacity value ridgeline plot. Defaults 0.8. locale Character string locale. Currently English locale supported. Defaults 'EN'.","code":""},{"path":"/reference/gr_plot_sep.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot hydrograph separation — gr_plot_sep","title":"Plot hydrograph separation — gr_plot_sep","text":"function plots river hydrograph filling different flow types using colors. Matrix layouts can used multiple plots needed. Temperature precipitation can overlaid.","code":""},{"path":"/reference/gr_plot_sep.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot hydrograph separation — gr_plot_sep","text":"","code":"gr_plot_sep(   df,   years = NULL,   layout = as.matrix(1),   pagebreak = FALSE,   temp = FALSE,   prec = FALSE,   span = 5,   locale = \"EN\" )"},{"path":"/reference/gr_plot_sep.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot hydrograph separation — gr_plot_sep","text":"df data.frame hydrograph separation produced gr_separate(). years Integer vector years plotted. layout matrix encodes order plotting. pagebreak Logical. Whether break page plots (used gr_report()). Defaults FALSE. temp Boolean. Add temperature curve plot? Defaults FALSE. temp = TRUE prec = TRUE, axis drawn precipitation. prec Boolean. Add precipitation curve plot? Defaults FALSE. temp = TRUE prec = TRUE, axis drawn precipitation. span Integer number days accumulate precipitation plotting. locale Character string locale. Currently English locale supported. Defaults 'EN'.","code":""},{"path":"/reference/gr_plot_tests.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot change year density — gr_plot_tests","title":"Plot change year density — gr_plot_tests","text":"function extracts change years results test_variables() plots probability density. Since every variable change year individual, procedure allows finding one probable year, mode distribution. year highlighted line labeled plot.","code":""},{"path":"/reference/gr_plot_tests.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot change year density — gr_plot_tests","text":"","code":"gr_plot_tests(tests, locale = \"EN\")"},{"path":"/reference/gr_plot_tests.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot change year density — gr_plot_tests","text":"tests list tests generated test_variables(). locale Character string locale. Currently English locale supported. Defaults 'EN'.","code":""},{"path":"/reference/gr_plot_vars.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot interannual hydrograph variable changes — gr_plot_vars","title":"Plot interannual hydrograph variable changes — gr_plot_vars","text":"function plots hydrograph separation variables produced gr_summarize(). Different background fill colors line types used differentiate seasons variable types.","code":""},{"path":"/reference/gr_plot_vars.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot interannual hydrograph variable changes — gr_plot_vars","text":"","code":"gr_plot_vars(   df,   ...,   tests = NULL,   exclude = NULL,   smooth = TRUE,   layout = as.matrix(1),   pagebreak = FALSE,   locale = \"EN\" )"},{"path":"/reference/gr_plot_vars.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot interannual hydrograph variable changes — gr_plot_vars","text":"df data.frame hydrograph meteorological variables produced gr_summarize(). ... Quoted sequence variable names. tests list tests variables (generated test_variables() function). tests specified, added plot. exclude Integer vector years excluded plotting. smooth Logical. TRUE local smoothing regression plotted. Defaults TRUE. layout matrix encodes order plotting. pagebreak Logical. Whether break page plots (gr_report()). Defaults FALSE. locale Character string locale. Currently English locale supported. Defaults 'EN'.","code":""},{"path":"/reference/gr_read_rean.html","id":null,"dir":"Reference","previous_headings":"","what":"Read reanalysis data — gr_read_rean","title":"Read reanalysis data — gr_read_rean","text":"function reads meteorological variables (temperature precipitation) grwat reanalysis daily runoff time series. Reanalysis covers East European Plain 0.75 degrees spatial resolution obtained based CIRES-DOE (1880-1949) ERA5 (1950-2021) data.","code":""},{"path":"/reference/gr_read_rean.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Read reanalysis data — gr_read_rean","text":"","code":"gr_read_rean(file_prec, file_temp)"},{"path":"/reference/gr_read_rean.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Read reanalysis data — gr_read_rean","text":"file_prec Character string path precipitation NetCDF file. file_temp Character string path temperature NetCDF file.","code":""},{"path":"/reference/gr_read_rean.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Read reanalysis data — gr_read_rean","text":"list containing time series, precipitation series, temperature series spatial points (sf)","code":""},{"path":"/reference/gr_read_rean.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Read reanalysis data — gr_read_rean","text":"Download reanalysis archive http://carto.geogr.msu.ru/grwat/.","code":""},{"path":"/reference/gr_report.html","id":null,"dir":"Reference","previous_headings":"","what":"Report hydrograph separation and variables — gr_report","title":"Report hydrograph separation and variables — gr_report","text":"function generates graphical HTML report summarizes separation hydrograph, variables statistical properties.","code":""},{"path":"/reference/gr_report.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Report hydrograph separation and variables — gr_report","text":"","code":"gr_report(   sep,   vars,   output = \"Report.html\",   year = NULL,   exclude = NULL,   temp = FALSE,   prec = FALSE,   span = 5,   locale = \"EN\" )"},{"path":"/reference/gr_report.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Report hydrograph separation and variables — gr_report","text":"sep data.frame hydrograph separation returned gr_separate() function. vars data.frame hydrograph variables returned gr_summarize() function. output Character string path output file. Must .html extension. year Integer value year used divide series two samples compared Student Fisher tests. Defaults NULL means year calculated automatically Pettitt test. Defaults NULL. exclude Integer vector years excluded reporting. Defaults NULL. temp Boolean. Plot temperature top hydrograph? Defaults FALSE. temp = TRUE prec = TRUE, axis drawn precipitation. prec Boolean. Plot precipitation top hydrograph? Defaults FALSE. temp = TRUE prec = TRUE, axis drawn precipitation. span Integer number days accumulate precipitation plotting. Defaults 5. locale Character string locale. Currently English locale supported. Defaults 'EN'.","code":""},{"path":"/reference/gr_separate.html","id":null,"dir":"Reference","previous_headings":"","what":"Advanced hydrograph separation — gr_separate","title":"Advanced hydrograph separation — gr_separate","text":"Separates runoff genetic components: groundwater, thaw, rain spring","code":""},{"path":"/reference/gr_separate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Advanced hydrograph separation — gr_separate","text":"","code":"gr_separate(df, params = gr_get_params(), debug = FALSE)"},{"path":"/reference/gr_separate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Advanced hydrograph separation — gr_separate","text":"df data.frame four columns: date, runoff, temperature, precipitation. params list separation parameters, returned gr_get_params() function.","code":""},{"path":"/reference/gr_separate.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Advanced hydrograph separation — gr_separate","text":"data.frame 11 columns:","code":""},{"path":"/reference/gr_separate.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Advanced hydrograph separation — gr_separate","text":"","code":"library(grwat)  data(spas) # example Spas-Zagorye data is included with grwat package  # separate sep = gr_separate(spas, params = gr_get_params(reg = 'Midplain')) #> grwat: data frame is correct #> grwat:  parameters list and types are OK  # Visualize gr_plot_sep(sep, c(1978, 1989))  #> Warning: Removed 2 rows containing missing values (position_stack).    # Debug mode gives access to additional information sep_debug = gr_separate(spas, params = gr_get_params(reg = 'Midplain'), debug = TRUE) #> grwat: data frame is correct #> grwat:  parameters list and types are OK #> Warning: grwat: 1974, 1975 years were not separated. Check the input data for possible errors. Use gr_get_gaps() and gr_fill_gaps() functions to detect and fill missing data. #> Warning: grwat: 1965, 1978, 1989, 1991, 1995, 1996, 1997, 1998, 2002, 2007, 2008, 2009, 2011, 2014, 2015, 2016, 2017, 2019, 2020 years were processed with jittered parameters  # a vector of years with jittered params jit = attributes(sep_debug)$jittered jit #>  [1] 1965 1978 1989 1991 1995 1996 1997 1998 2002 2007 2008 2009 2011 2014 2015 #> [16] 2016 2017 2019 2020  # actual params used for each year parlist = attributes(sep_debug)$params partab = do.call(dplyr::bind_rows, parlist) # View as table head(partab) #> # A tibble: 6 × 39 #>   winmon grad1 grad2 gratio ftmon1 ftmon2 ftrisedays1 ftrisedays2 ftdays ftrise #>    <dbl> <dbl> <dbl>  <dbl>  <dbl>  <dbl>       <dbl>       <dbl>  <dbl>  <dbl> #> 1     11     1   1.5   1500      1      5           5          15     25     10 #> 2     11     1   1.5   1500      1      5           5          15     25     10 #> 3     11     1   1.5   1500      1      5           5          15     25     10 #> 4     11     1   1.5   1500      1      5           5          15     25     10 #> 5     11     1   1.5   1500      1      5           5          15     25     10 #> 6     11     1   1.5   1500      1      5           5          15     25     10 #> # … with 29 more variables: ftratio <dbl>, ftrecdays <dbl>, precdays <dbl>, #> #   frostdays <dbl>, windays <dbl>, floodprec <dbl>, floodtemp <dbl>, #> #   frosttemp <dbl>, wintemp <dbl>, signratio1 <dbl>, signratio2 <dbl>, #> #   floodratio <dbl>, gaplen <dbl>, snowtemp <dbl>, gradabs <dbl>, #> #   mntmode <dbl>, mntgrad <dbl>, mntavgdays <dbl>, mntratiodays <dbl>, #> #   mntratio <dbl>, niter <dbl>, a <dbl>, k <dbl>, C <dbl>, aq <dbl>, #> #   padding <dbl>, passes <dbl>, filter <chr>, ftcomp <dbl>"},{"path":"/reference/gr_set_param.html","id":null,"dir":"Reference","previous_headings":"","what":"Set the value of selected parameter for selected years in parameter list — gr_set_param","title":"Set the value of selected parameter for selected years in parameter list — gr_set_param","text":"Set value selected parameter selected years parameter list","code":""},{"path":"/reference/gr_set_param.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Set the value of selected parameter for selected years in parameter list — gr_set_param","text":"","code":"gr_set_param(params, p, value, years = NULL)"},{"path":"/reference/gr_set_param.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Set the value of selected parameter for selected years in parameter list — gr_set_param","text":"params list lists hydrograph separation parameters returned params attribute gr_separate()  debug = TRUE. p Name parameter. value Numeric value set. years Integer vector years modify. Defaults NULL, means years modified.","code":""},{"path":"/reference/gr_set_param.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Set the value of selected parameter for selected years in parameter list — gr_set_param","text":"list lists — modified version params","code":""},{"path":"/reference/gr_set_params.html","id":null,"dir":"Reference","previous_headings":"","what":"Change separation parameters through graphical interface — gr_set_params","title":"Change separation parameters through graphical interface — gr_set_params","text":"Change separation parameters graphical interface","code":""},{"path":"/reference/gr_set_params.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Change separation parameters through graphical interface — gr_set_params","text":"","code":"gr_set_params(params)"},{"path":"/reference/gr_set_params.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Change separation parameters through graphical interface — gr_set_params","text":"params Parameters list","code":""},{"path":[]},{"path":"/reference/gr_summarize.html","id":null,"dir":"Reference","previous_headings":"","what":"Summarize hydrograph separation — gr_summarize","title":"Summarize hydrograph separation — gr_summarize","text":"Use function get meaningful summary statistics hydrograph separation. Resulting variables described gr_help_vars(). function convenient wrapper around dplyr's df %>% group_by %>% summarize idiom.","code":""},{"path":"/reference/gr_summarize.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summarize hydrograph separation — gr_summarize","text":"","code":"gr_summarize(df)"},{"path":"/reference/gr_summarize.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summarize hydrograph separation — gr_summarize","text":"df data.frame hydrograph separation resulting gr_separate() function","code":""},{"path":"/reference/gr_summarize.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summarize hydrograph separation — gr_summarize","text":"data.frame one row water-resources year multiple columns statistics.","code":""},{"path":"/reference/gr_test_vars.html","id":null,"dir":"Reference","previous_headings":"","what":"Test hydrograph changes — gr_test_vars","title":"Test hydrograph changes — gr_test_vars","text":"Use function test interannual changes hydrograph separation variables returned gr_summarize(). Pettitt test used detect change year — .e. year divides time series statistically differing samples. Student (Welch) Fisher tests used estimate significance mean variance differences samples. Theil-Sen test calculates trend slope value. Mann-Kendall test performed reveal significance trend.","code":""},{"path":"/reference/gr_test_vars.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Test hydrograph changes — gr_test_vars","text":"","code":"gr_test_vars(df, ..., year = NULL, exclude = NULL, locale = \"EN\")"},{"path":"/reference/gr_test_vars.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Test hydrograph changes — gr_test_vars","text":"df data.frame produced gr_summarize() function. ... Names tested variables (quoted). year Integer value year used divide series two samples compared Student Fisher tests. Defaults NULL means year calculated automatically Pettitt test. exclude Integer vector years excluded tests. locale Character string locale. Currently English locale supported. Defaults 'EN'.","code":""},{"path":"/reference/gr_test_vars.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Test hydrograph changes — gr_test_vars","text":"list testing results","code":""},{"path":"/reference/gr_test_vars.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Test hydrograph changes — gr_test_vars","text":"Number observations formally required various tests: Pettitt > 0, Mann-Kendall > 2, Theil-Sen > 1, Student > 1, Fisher > 1.","code":""},{"path":"/reference/pipe.html","id":null,"dir":"Reference","previous_headings":"","what":"Pipe operator — %>%","title":"Pipe operator — %>%","text":"See magrittr::%>% details.","code":""},{"path":"/reference/pipe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pipe operator — %>%","text":"","code":"lhs %>% rhs"},{"path":"/reference/pipe.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Pipe operator — %>%","text":"lhs value magrittr placeholder. rhs function call using magrittr semantics.","code":""},{"path":"/reference/pipe.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Pipe operator — %>%","text":"result calling rhs(lhs).","code":""}]
