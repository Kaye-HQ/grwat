[{"path":[]},{"path":"/articles/grwat.html","id":"read-raw-discharge-data","dir":"Articles","previous_headings":"","what":"Read raw discharge data","title":"Introduction to grwat R package","text":"starting point hydrograph analysis obtain source data. Let’s see goes sample spas-zagorye.txt discharge data \\(1956-2020\\) year range provided grwat. data Spas-Zagorye gauge Protva river Central European plane: grwat expects date single column. Therefore, case construct manually. convenient use make_date() function lubridate package: basic data structure grwat separation function data frame (tibble) two columns: date (first column) discharge (second column). columns can names, necessarily D Q.","code":"library(sf) # reading and manipulating spatial data library(tidyverse) # general data wrangling library(mapview) # interactive mapping of spatial data library(grwat)  mapviewOptions(fgb = FALSE)  # this is path to sample data installed with grwat path = system.file(\"extdata\", \"spas-zagorye.txt\",                     package = \"grwat\")  # for your own data just provide the full path: # path = /this/is/the/path/to/discharge/discharge.csv  hdata_raw = read_delim(path,                     col_names = c('d', 'm', 'y', 'q'),                     col_types = 'iiid', delim = ' ') # read gauge data head(hdata_raw) # see the data #> # A tibble: 6 × 4 #>       d     m     y     q #>   <int> <int> <int> <dbl> #> 1     1     1  1956  5.18 #> 2     2     1  1956  5.18 #> 3     3     1  1956  5.44 #> 4     4     1  1956  5.44 #> 5     5     1  1956  5.44 #> 6     6     1  1956  5.58 hdata = hdata_raw %>%    transmute(Date = lubridate::make_date(y, m, d),              Q = q) head(hdata) #> # A tibble: 6 × 2 #>   Date           Q #>   <date>     <dbl> #> 1 1956-01-01  5.18 #> 2 1956-01-02  5.18 #> 3 1956-01-03  5.44 #> 4 1956-01-04  5.44 #> 5 1956-01-05  5.44 #> 6 1956-01-06  5.58"},{"path":"/articles/grwat.html","id":"fill","dir":"Articles","previous_headings":"","what":"Fill gaps","title":"Introduction to grwat R package","text":"Hydrograph data may contain empty values due corrupted records missed observations specific dates. short summary gap periods can obtained gr_get_gaps() function: gr_fill_gaps() function allows filling gaps data. function first expands date sequence dates missing minimum maximum date table, trims sequence dates missing obervations beginning end sequence. expansion missing observations filled linear interpolation nearest values. can limit maximum gap extent threshold autocorrelation value (autocorr parameter) expliсit number observations (nobserv parameter): time window computed first case? autocorr parameter used, ACF (autocorrelation function) computed first, values used obtain time shift (days) autocorrelation higher equal specified value. Spas-Zagorye data time lag \\(ACF \\geq 0.7\\) 6 days, can inferred gr_plot_acf() function:","code":"gaps = gr_get_gaps(hdata) gaps #> # A tibble: 8 × 5 #>     num start_date end_date   duration   type  #>   <int> <date>     <date>     <drtn>     <chr> #> 1     1 1956-01-01 1970-04-09  5213 days data  #> 2     2 1970-04-10 1970-04-12     3 days gap   #> 3     3 1970-04-13 1979-09-09  3437 days data  #> 4     4 1979-09-10 1979-09-11     2 days gap   #> 5     5 1979-09-12 2011-05-09 11563 days data  #> 6     6 2011-05-10 2011-05-14     5 days gap   #> 7     7 2011-05-15 2020-12-26  3514 days data  #> 8     8 2020-12-27 2020-12-31     5 days gap fhdata = gr_fill_gaps(hdata, autocorr = 0.7) #> grwat: filled 10 observations using 5 days window for each variable fhdata = gr_fill_gaps(hdata, nobserv = 10) #> grwat: filled 10 observations using 10 days window for each variable gr_plot_acf(hdata, 0.5)"},{"path":"/articles/grwat.html","id":"join-meteorological-variables","dir":"Articles","previous_headings":"","what":"Join meteorological variables","title":"Introduction to grwat R package","text":"sole discharge data enough separate hydrograph quickflow baseflow, sufficient predict genesis quickflow cases. due rain thaw? answer questions also need precipitation temperature data. Ideally, must measured gauge. often data available. case need mine data external sources. One ways obtain temperature precipitation data use reanalyses ERA5. Reanalysis data arranged regular grids specific resolution. particular, ERA5 data \\(31\\) km \\(0.28125\\) degrees resolution. use data must tolerate fact none reanalysis grid nodes coincide gauge. Instead, use data, either closest reanalysis point points falling within buffer zone gauge points falling within basin gauge. points falling within buffer zone basin gauge. last two options adequate. Let’s see can done.","code":""},{"path":"/articles/grwat.html","id":"basin-buffered-basin-or-buffered-gauge","dir":"Articles","previous_headings":"Join meteorological variables","what":"Basin, buffered basin or buffered gauge","title":"Introduction to grwat R package","text":"First, need read basin spatial data: Next, can buffer data specified distance catch reanalysis data. use gr_buffer_geo function, approximates geographic buffer specified radius: Alternatively can just buffer gauge point, though less meaningful since grab reanalysis data falls gauge’s basin:","code":"# this is path to sample basin geopackage installed with grwat path = system.file(\"extdata\", \"spas-zagorye.gpkg\", package = \"grwat\")  # for your own data just provide the full path: # path = /this/is/the/path/to/discharge/basin.shp  basin = st_read(path, layer = 'basin') # read basin region #> Reading layer `basin' from data source  #>   `/private/var/folders/5s/rkxr4m8j24569d_p6nj9ld200000gn/T/Rtmppnlrit/temp_libpath142581ad8fa5e/grwat/extdata/spas-zagorye.gpkg'  #>   using driver `GPKG' #> Simple feature collection with 1 feature and 7 fields #> Geometry type: MULTIPOLYGON #> Dimension:     XY #> Bounding box:  xmin: 35.41204 ymin: 54.88195 xmax: 36.84138 ymax: 55.57005 #> Geodetic CRS:  WGS 84 gauge = st_read(path, layer = 'gauge') # read gauge point #> Reading layer `gauge' from data source  #>   `/private/var/folders/5s/rkxr4m8j24569d_p6nj9ld200000gn/T/Rtmppnlrit/temp_libpath142581ad8fa5e/grwat/extdata/spas-zagorye.gpkg'  #>   using driver `GPKG' #> Simple feature collection with 1 feature and 0 fields #> Geometry type: POINT #> Dimension:     XY #> Bounding box:  xmin: 36.62272 ymin: 55.03669 xmax: 36.62272 ymax: 55.03669 #> Geodetic CRS:  WGS 84 mapview(basin) + mapview(gauge) basin_buffer = gr_buffer_geo(basin, 25000)  mapview(basin_buffer, col.regions = 'red') +   mapview(basin) gauge_buffer = gr_buffer_geo(gauge, 50000)  mapview(gauge_buffer, col.regions = 'red') +   mapview(gauge)"},{"path":"/articles/grwat.html","id":"joining-the-east-european-plane-reanalysis","dir":"Articles","previous_headings":"Join meteorological variables","what":"Joining the East-European Plane reanalysis","title":"Introduction to grwat R package","text":"grwat packaged daily reanalysis covers East European territory Russia. spatial resolution \\(0.75^{\\circ} \\times 0.75^{\\circ}\\), temporal resolution \\(1\\) (one) day. Data sources include: CIRES-DOE 01-01-1880 till 31-12-1978 ERA5 01-01-1979 till now. coverage reanalysis shown :  reanalysis consists two data files, file 850 Mb size:  Download data using FTP link using grwat. reanalysis data joined can easily plot map derived spatial configuration:","code":"rean = gr_read_rean(   '/Volumes/Data/Spatial/Reanalysis/grwat/pre_1880-2021.nc',   '/Volumes/Data/Spatial/Reanalysis/grwat/temp_1880-2021.nc' ) # read reanalysis data  fhdata_rean = gr_join_rean(fhdata, rean, basin_buffer) # join reanalysis data to hydrological series #> Joining, by = \"Date\"  head(fhdata_rean) #> # A tibble: 6 × 4 #>   Date           Q   Temp  Prec #>   <date>     <dbl>  <dbl> <dbl> #> 1 1956-01-01  5.18  -6.46 0.453 #> 2 1956-01-02  5.18 -11.4  0.825 #> 3 1956-01-03  5.44 -10.7  0.26  #> 4 1956-01-04  5.44  -8.05 0.397 #> 5 1956-01-05  5.44 -11.7  0.102 #> 6 1956-01-06  5.58 -20.1  0.032 # plot spatial configuration m = mapview(basin_buffer, col.regions = 'red') +   mapview(basin) +   mapview(rean$pts[basin_buffer, ], col.regions = 'black') +   mapview(rean$pts, cex = 1)  box = st_bbox(basin_buffer) center = st_coordinates(st_centroid(basin_buffer)) #> Warning in st_centroid.sf(basin_buffer): st_centroid assumes attributes are #> constant over geometries of x  m@map %>% leaflet::setView(center[1], center[2], zoom = 7)"},{"path":"/articles/grwat.html","id":"joining-the-era5-reanalysis","dir":"Articles","previous_headings":"Join meteorological variables","what":"Joining the ERA5 reanalysis","title":"Introduction to grwat R package","text":"described","code":""},{"path":[]},{"path":"/articles/grwat.html","id":"separate-basic","dir":"Articles","previous_headings":"","what":"Basic separation: quickflow and baseflow","title":"Introduction to grwat R package","text":"basic separation procedure provided get_baseflow() function. One commonly used approaches method Lyne-Hollick (1979):  separation mainly parameterized smoothing parameter = 0.925 default, number passes, passes = 3 default. Changing affects shape baseflow component:  Let’s see different separation methods act comparison :","code":"resbase = fhdata %>%    mutate(Qbase = gr_baseflow(Q, method = 'lynehollick'))  # quick look at the table head(resbase, 10) #> # A tibble: 10 × 3 #>    Date           Q Qbase #>    <date>     <dbl> <dbl> #>  1 1956-01-01  5.18  3.70 #>  2 1956-01-02  5.18  3.79 #>  3 1956-01-03  5.44  3.88 #>  4 1956-01-04  5.44  3.96 #>  5 1956-01-05  5.44  4.04 #>  6 1956-01-06  5.58  4.11 #>  7 1956-01-07  5.58  4.19 #>  8 1956-01-08  5.36  4.25 #>  9 1956-01-09  5.36  4.32 #> 10 1956-01-10  5.31  4.38    resbase %>%    filter(lubridate::year(Date) == 2020) %>%    ggplot() +     geom_area(aes(Date, Q), fill = 'steelblue',                color = 'black') +     geom_area(aes(Date, Qbase), fill = 'orangered',                color = 'black') #> Warning: Removed 5 rows containing missing values (position_stack). #> Removed 5 rows containing missing values (position_stack). resbase = fhdata %>%    mutate(Qbase = gr_baseflow(Q, method = 'lynehollick',                               a = 0.8, passes = 5))    resbase %>%    filter(lubridate::year(Date) == 2020) %>%    ggplot() +     geom_area(aes(Date, Q), fill = 'steelblue',                color = 'black') +     geom_area(aes(Date, Qbase), fill = 'orangered',                color = 'black') #> Warning: Removed 5 rows containing missing values (position_stack). #> Removed 5 rows containing missing values (position_stack). methods = c(\"maxwell\",             \"boughton\",             \"jakeman\",             \"lynehollick\",             \"chapman\")  plots = lapply(methods, function(m) {   resbase = fhdata %>%      mutate(Qbase = gr_baseflow(Q, method = m))    resbase %>%     filter(lubridate::year(Date) == 2020) %>%      ggplot() +       geom_area(aes(Date, Q), fill = 'steelblue', color = 'black') +       geom_area(aes(Date, Qbase), fill = 'orangered', color = 'black') +       labs(title = m) })  patchwork::wrap_plots(plots, ncol = 2) #> Warning: Removed 5 rows containing missing values (position_stack). #> Removed 5 rows containing missing values (position_stack). #> Removed 5 rows containing missing values (position_stack). #> Removed 5 rows containing missing values (position_stack). #> Removed 5 rows containing missing values (position_stack). #> Removed 5 rows containing missing values (position_stack). #> Removed 5 rows containing missing values (position_stack). #> Removed 5 rows containing missing values (position_stack). #> Removed 5 rows containing missing values (position_stack). #> Removed 5 rows containing missing values (position_stack)."},{"path":"/articles/grwat.html","id":"separate-advanced","dir":"Articles","previous_headings":"","what":"Advanced separation: genetic components","title":"Introduction to grwat R package","text":"Advanced separation aims revealing genesis quickflow. due rain snowmelting? , joint analysis discharge, temperature precipitation time series performed specialized algorithm, available gr_separate() function grwat package. genetic separation hydrograph controlled 30 parameters. names meaning parameters can learned thanks gr_help_params() function: Since number parameters large (31), organized list, fed gr_separate() function. First, get params using gr_get_params() function. parameter function reg, indicates region parameters must extracted. got parameters, can changed accessing list elements: Next, can separate hydrograph: hydrograph separated, can summarized set variables:","code":"View(gr_help_params()) # Расчленение p = gr_get_params(reg = 'Midplain') p$precdays = 5 p$ftrecdays = 85 sep = gr_separate(fhdata_rean, p) #> grwat:  parameters list and types are OK #> Warning in gr_separate(fhdata_rean, p): grwat: #> 1974, 1975, 1998, 2008, 2015 years were not separated. Check #> the input data for possible errors. Use gr_get_gaps() and #> gr_fill_gaps() functions to detect and fill missing data. #> Warning in gr_separate(fhdata_rean, p): grwat: #> 1965, 1978, 1989, 1991, 1995, 1996, 1997, 1998, 2002, 2007, 2008, 2009, #> 2011, 2014, 2015, 2016, 2017, 2019, 2020 years were processed with #> jittered parameters head(sep) #> # A tibble: 6 × 13 #>   Date           Q Qbase Quick Qseas Qrain Qthaw   Qpb  Type  Year Jittered #>   <date>     <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <int> <int>    <int> #> 1 1956-01-01  5.18    NA    NA    NA    NA    NA    NA    NA    NA        0 #> 2 1956-01-02  5.18    NA    NA    NA    NA    NA    NA    NA    NA        0 #> 3 1956-01-03  5.44    NA    NA    NA    NA    NA    NA    NA    NA        0 #> 4 1956-01-04  5.44    NA    NA    NA    NA    NA    NA    NA    NA        0 #> 5 1956-01-05  5.44    NA    NA    NA    NA    NA    NA    NA    NA        0 #> 6 1956-01-06  5.58    NA    NA    NA    NA    NA    NA    NA    NA        0 #> # … with 2 more variables: Temp <dbl>, Prec <dbl> vars = gr_summarize(sep) head(vars) #> # A tibble: 6 × 57 #>    Year Year1 Year2 datestart  datepolend PolProd    Qy  Qmax datemax     Qygr #>   <int> <int> <dbl> <date>     <date>       <int> <dbl> <dbl> <date>     <dbl> #> 1  1956  1956  1957 1956-04-14 1956-05-05      21  18.5   467 1956-04-22  8.44 #> 2  1957  1957  1958 1957-03-28 1957-05-22      55  20.3   460 1957-04-08  9.34 #> 3  1958  1958  1959 1958-04-04 1958-05-16      42  27.4   537 1958-04-21  9.90 #> 4  1959  1959  1960 1959-03-28 1959-04-27      30  27.1   406 1959-04-16 10.6  #> 5  1960  1960  1961 1960-03-27 1960-04-26      30  29.4   406 1960-04-15 12.0  #> 6  1961  1961  1962 1961-03-11 1961-05-06      56  18.7   296 1961-04-10 10.5  #> # … with 47 more variables: Qmmsummer <dbl>, monmmsummer <date>, Qmmwin <dbl>, #> #   nommwin <date>, Q30s <dbl>, date30s1 <date>, date30s2 <date>, Q30w <dbl>, #> #   date30w1 <date>, date30w2 <date>, Q10s <dbl>, date10s1 <date>, #> #   date10s2 <date>, Q10w <dbl>, date10w1 <date>, date10w2 <date>, Q5s <dbl>, #> #   date5s1 <date>, date5s2 <date>, Q5w <dbl>, date5w1 <date>, date5w2 <date>, #> #   Wy <dbl>, Wgr <dbl>, Wpol2 <dbl>, Wpol1 <dbl>, Wpol3 <dbl>, Wpavs2 <dbl>, #> #   Wpavs1 <dbl>, Wpavthaw2 <dbl>, Wpavthaw1 <dbl>, WgrS <dbl>, WS <dbl>, …"},{"path":"/articles/grwat.html","id":"plot-and-test","dir":"Articles","previous_headings":"","what":"Plot and test","title":"Introduction to grwat R package","text":"functions grwat package allow : Plot separation hydrograph Plot interannual changes key water discharge variables Plot long-term changes key water discharge variables Perform statistical tests calculated variables Graphical functions based ggplot2 graphics.","code":""},{"path":"/articles/grwat.html","id":"plot-separation-of-hydrograph","dir":"Articles","previous_headings":"","what":"Plot separation of hydrograph","title":"Introduction to grwat R package","text":"can plot separations selected years using gr_plot_sep() function:    also multiple years layout:","code":"gr_plot_sep(sep, 1976) # plot single year #> Warning: Removed 1 rows containing missing values (position_stack). gr_plot_sep(sep, c(2016, 2017)) # plot two years sequentially #> Warning: Removed 1 rows containing missing values (position_stack). gr_plot_sep(sep, 1976:1979, # plot four years on the same page             layout = matrix(c(1,2,3,4), ncol=2, byrow = T)) #> Warning: Removed 1 rows containing missing values (position_stack). #> Removed 1 rows containing missing values (position_stack). #> Warning: Removed 2 rows containing missing values (position_stack)."},{"path":"/articles/grwat.html","id":"interannual-change-variables","dir":"Articles","previous_headings":"","what":"Interannual change variables","title":"Introduction to grwat R package","text":"get detailed description available variables can invoke gr_help_vars(): Parameters can statistically tested using test_variables(df, ..., year = NULL, locale='EN') function. Names parameters passed comma-separated place .... quoted, need pass character strings, just write names: example three variables selected: want test parameters, just skip variable names: Long-term changes tested breaking year, calculated variable using Pettitt test. However, want use fixed year, pass desired breaking year change_year parameter:","code":"View(gr_help_vars()) gr_test_vars(vars, Qmax) #> Warning: `select_()` was deprecated in dplyr 0.7.0. #> Please use `select()` instead. #> This warning is displayed once every 8 hours. #> Call `lifecycle::last_lifecycle_warnings()` to see where this warning was generated. #> $ptt #> $ptt$Qmax #>  #>  Pettitt's test for single change-point detection #>  #> data:  vl[vl_cmp] #> U* = 410, p-value = 0.01599 #> alternative hypothesis: two.sided #> sample estimates: #> probable change point at time K  #>                              15  #>  #>  #>  #> $mkt #> $mkt$Qmax #>  #>  Mann-Kendall trend test #>  #> data:  vl[vl_cmp] #> z = -3.3029, n = 59, p-value = 0.0009568 #> alternative hypothesis: true S is not equal to 0 #> sample estimates: #>             S          varS           tau  #>  -506.0000000 23376.6666667    -0.2963403  #>  #>  #>  #> $tst #> $tst$Qmax #>  #>  Sen's slope #>  #> data:  df.theil[[2]][fltr] #> z = -3.3029, n = 59, p-value = 0.0009568 #> alternative hypothesis: true z is not equal to 0 #> 95 percent confidence interval: #>  -5.975610 -1.605263 #> sample estimates: #> Sen's slope  #>          -4  #>  #>  #>  #> $ts_fit #> $ts_fit$Qmax #>  #> Call: #> mblm::mblm(formula = eval(frml), dataframe = df.theil[fltr, ],  #>     repeated = FALSE) #>  #> Coefficients: #> (Intercept)        Year1   #>    7596.086       -3.686   #>  #>  #>  #> $tt #> $tt$Qmax #>  #>  Welch Two Sample t-test #>  #> data:  d1 and d2 #> t = 3.3226, df = 19.72, p-value = 0.003444 #> alternative hypothesis: true difference in means is not equal to 0 #> 95 percent confidence interval: #>   59.93319 262.61602 #> sample estimates: #> mean of x mean of y  #>  419.7857  258.5111  #>  #>  #>  #> $ft #> $ft$Qmax #>  #>  F test to compare two variances #>  #> data:  d1 and d2 #> F = 1.2841, num df = 13, denom df = 44, p-value = 0.5169 #> alternative hypothesis: true ratio of variances is not equal to 1 #> 95 percent confidence interval: #>  0.5797229 3.5489038 #> sample estimates: #> ratio of variances  #>           1.284116  #>  #>  #>  #> $year #> Qmax  #> 1970  #>  #> $maxval #> $maxval$Qmax #> [1] 780 #>  #>  #> $fixed_year #> [1] FALSE #>  #> $pvalues #>   N                                            Variable Change.Year    Trend #> 1 1 Maximum annual discharge during seasonal flood wave        1970 -3.68571 #>         M1       M2 MeanRatio      sd1      sd2 sdRatio Mann.Kendall Pettitt #> 1 419.7857 258.5111     -38.4 162.9446 143.7931   -11.8      0.00096 0.01599 #>   Student  Fisher #> 1 0.00344 0.51694 tests = gr_test_vars(vars, Qygr, date10w1, Wpol3) tests$pvalues #>   N                                                              Variable #> 1 1 Annual groundwater discharge (\"baseflow\") during water-resources year #> 2 2                   First date of 10-day window discharge during winter #> 3 3                Seasonal flood runoff (with groundwater and rainwater) #>   Change.Year    Trend       M1       M2 MeanRatio      sd1      sd2 sdRatio #> 1        1979  0.09279  9.09854 13.96711      53.5  1.89033  2.34799    24.2 #> 2        1987 -0.23529   29-Jan   17-Jan     -12.0 31.00000 33.00000     6.5 #> 3        1988 -0.07191 12.35758  9.26229     -25.0  5.58861  3.97223   -28.9 #>   Mann.Kendall Pettitt Student  Fisher #> 1      0.00001 0.00000 0.00000 0.30350 #> 2      0.39510 0.64851 0.15902 0.76457 #> 3      0.00998 0.04446 0.01729 0.07446 tests = gr_test_vars(vars) tests$year # this is a change year detected for each variable #>             Wy          Wpol2            Wgr          Wpol1         Wpavs2  #>           1978           1988           1978           1988           1972  #>         Wpavs1      Wpavthaw2      Wpavthaw1           WgrW             WW  #>           1972           1972           1972           1978           1978  #>           WgrS             WS             Qy      datestart           Qygr  #>           1972           1972           1978           1972           1979  #>     datepolend        PolProd           Qmax        datemax          Wpol3  #>           1970           1988           1970           1970           1988  #>         Qmmwin        nommwin      Qmmsummer    monmmsummer           Q30w  #>           1979           1965           1979           2000           1979  #>       date30w1           Q30s       date30s1           Q10w       date10w1  #>           1995           1979           2000           1979           1987  #>           Q10s       date10s1            Q5w        date5w1            Q5s  #>           1981           2000           1979           1987           1981  #>        date5s1    Qmaxpavthaw datemaxpavthaw     CountThaws    DaysThawWin  #>           2000           1977           1995           1970           1984  #>       Qmaxpavs    datemaxpavs      CountPavs    DaysPavsSum          CvWin  #>           1994           2002           1977           1968           1983  #>        WinProd          CvSum        SumProd  #>           1968           1970           1968 tests = gr_test_vars(vars, Qmax, Qygr, change_year = 1987) tests$ft # Fisher F tests to compare two variances #> $Qmax #>  #>  F test to compare two variances #>  #> data:  d1 and d2 #> F = 1.2841, num df = 13, denom df = 44, p-value = 0.5169 #> alternative hypothesis: true ratio of variances is not equal to 1 #> 95 percent confidence interval: #>  0.5797229 3.5489038 #> sample estimates: #> ratio of variances  #>           1.284116  #>  #>  #> $Qygr #>  #>  F test to compare two variances #>  #> data:  d1 and d2 #> F = 0.64816, num df = 20, denom df = 37, p-value = 0.3035 #> alternative hypothesis: true ratio of variances is not equal to 1 #> 95 percent confidence interval: #>  0.308895 1.492356 #> sample estimates: #> ratio of variances  #>          0.6481573"},{"path":"/articles/grwat.html","id":"plot-interannual-changes","dir":"Articles","previous_headings":"","what":"Plot interannual changes","title":"Introduction to grwat R package","text":"Interannual changes visualized using gr_plot_vars() function. syntax similar gr_test_vars() gr_plot_sep():     can add results statistical tests plot specifying tests = TRUE function call. case subtitle test results added, Theil-Sen slope Pettitt test breaking year drawn solid (\\(p \\leq 0.05\\)) dashed (\\(p > 0.05\\)) lines:   Alternatively, can pass tests result test_variables(), need precompute specific parameters (example, setting exclude year: Beware case test variables order used plotting. plot variables , B, C supply tests variables X, Y, Z, added without warnings, responsibility keep correspondence . Finally, can plot variables supplying column names plot_variables() function. case tests (want plot ) also calculated variables:","code":"gr_plot_vars(vars, Qmax) # plot one selected variable gr_plot_vars(vars, datestart) # plot one selected variable gr_plot_vars(vars, date10w1, Wpol3) # plot two variables sequentially gr_plot_vars(vars, Qmax, Qygr, date10w1, Wpol3, # plot four variables in matrix layout              layout = matrix(c(1,2,3,4), nrow=2, byrow=TRUE)) gr_plot_vars(vars, date10w1, Wpol3, DaysThawWin, Qmaxpavs,              tests = TRUE) # add test information #> Warning: Removed 5 rows containing non-finite values (stat_smooth). #> Warning: Removed 1 row(s) containing missing values (geom_path). #> Warning: Removed 5 rows containing missing values (geom_rect). gr_plot_vars(vars, date10w1, Wpol3, DaysThawWin, Qmaxpavs,              tests = gr_test_vars(vars, date10w1, Wpol3, DaysThawWin, Qmaxpavs, exclude = 1990)) # add test information gr_plot_vars(vars, tests = TRUE)"},{"path":"/articles/grwat.html","id":"plot-long-term-period-changes","dir":"Articles","previous_headings":"","what":"Plot long-term period changes","title":"Introduction to grwat R package","text":"Long-term changes differences summarized statistics one variable calculated two selected periods. statistics reflect differences distributions parameters, grwat visualizes box plots using gr_plot_periods() function. syntax similar gr_plot_vars() except must provide either tests year parameter. supplied tests prioritized (can also supply fixed year testing variables:    Multiple plots can combined one page using layout parameter:  plot long-term changes variables just skip variable names function call: also small helper function plots histogram minimal discharge month summer winter periods:","code":"gr_plot_periods(vars, Qy, year = 1978) gr_plot_periods(vars, Qy, tests = TRUE) gr_plot_periods(vars, Qy, tests = gr_test_vars(vars, Qy, year = 1985)) gr_plot_periods(vars, Qy, Qmax, date10w1, Wpol3,                 tests = TRUE,                 layout = matrix(1:4, nrow = 2)) gr_plot_periods(vars, tests = TRUE) gr_plot_minmonth(vars, year = 1985)"},{"path":"/articles/grwat.html","id":"plot-discharge-parameters","dir":"Articles","previous_headings":"","what":"Plot discharge parameters","title":"Introduction to grwat R package","text":"dedicated gr_plot_matrix() function plot whole time series convenient matrix form. Currently supports plotting value, seasons components discharge:    can also limit range years plotted:","code":"gr_plot_matrix(sep, type = 'value') #> Warning: Removed 147 rows containing missing values (geom_raster). gr_plot_matrix(sep, type = 'season') #> Warning: Removed 147 rows containing missing values (geom_raster). gr_plot_matrix(sep, type = 'component') #> Warning: Removed 147 rows containing missing values (geom_raster). gr_plot_matrix(sep, years = 1980:1995, type = 'component') #> Warning: Removed 36 rows containing missing values (geom_raster)."},{"path":"/articles/grwat.html","id":"hydrograph-comparisons","dir":"Articles","previous_headings":"","what":"Hydrograph comparisons","title":"Introduction to grwat R package","text":"Sometimes want compare hydrographs selected years. multiple ways R. explore three : overlayed, ridgeline horiaon plots. Since require small number manipulations via existing R packages, dedicated functionality grwat.","code":""},{"path":"/articles/grwat.html","id":"overlayed","dir":"Articles","previous_headings":"","what":"Overlayed","title":"Introduction to grwat R package","text":"simplest (necessarily effective) way compare multiple hydrographs just combine one plot:  can seen even case two hydrographs plot easy read. becomes nearly impossible increase number years:","code":"library(ggplot2) library(lubridate) #>  #> Attaching package: 'lubridate' #> The following objects are masked from 'package:base': #>  #>     date, intersect, setdiff, union  sep_sel = sep |>    filter(Year %in% c(1989, 2012))  ggplot(sep_sel, aes(ymd(20000101) + yday(Date), Q,                      fill = factor(Year), group = factor(Year))) +    geom_area(alpha = 0.8, position = \"identity\") +   geom_line() +   scale_x_date(date_labels = \"%b\", date_breaks = \"1 month\") +   theme_minimal() +   labs(x = 'Date', y = 'Discharge', fill = 'Year') sep_sel = sep |>    filter(Year %in% c(1960, 1965, 1989, 2001, 2012))  ggplot(sep_sel, aes(ymd(20000101) + yday(Date), Q,                      fill = factor(Year), group = factor(Year))) +    geom_area(alpha = 0.8, position = \"identity\") +   geom_line() +   scale_x_date(date_labels = \"%b\", date_breaks = \"1 month\") +   theme_minimal() +   labs(x = 'Date', y = 'Year')"},{"path":"/articles/grwat.html","id":"ridgeline","dir":"Articles","previous_headings":"","what":"Ridgeline","title":"Introduction to grwat R package","text":"interested shape relative dimensions hydrographs, want exact Y axis, can proceed ridgeline plots available ggridges package. grwat contains convenient wrapper called gr_plot_ridge():","code":"gr_plot_ridge(sep, years = c(1960, 1965, 1989, 2001, 2012))"},{"path":"/articles/grwat.html","id":"horizon","dir":"Articles","previous_headings":"","what":"Horizon","title":"Introduction to grwat R package","text":"Another alternative ridgeline plot horizon plot, can built ggHoriPlot package. Horizon plots compact allow viewing hydrographs . grwat contains convenient wrapper called gr_plot_hori():","code":"gr_plot_hori(sep, years = 1960:1980)"},{"path":"/articles/grwat.html","id":"reports","dir":"Articles","previous_headings":"","what":"Reports","title":"Introduction to grwat R package","text":"render HTML report just pass separation variables gr_report() function, provide output file name: See report generated command.","code":"report = paste(getwd(), 'Spas-Zagorye.html', sep = '/') gr_report(sep, vars, output = report) browseURL(report)"},{"path":"/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Timofey Samsonov. Author, maintainer. Ekaterina Retz. Contributor. Maria Kireeva. Contributor.","code":""},{"path":"/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Samsonov T (2022). grwat: Hydrograph separation analysis. R package version 0.0.1, https://github.com/tsamsonov/grwat.","code":"@Manual{,   title = {grwat: Hydrograph separation and analysis},   author = {Timofey Samsonov},   year = {2022},   note = {R package version 0.0.1},   url = {https://github.com/tsamsonov/grwat}, }"},{"path":"/index.html","id":"grwat","dir":"","previous_headings":"","what":"Hydrograph separation and analysis","title":"Hydrograph separation and analysis","text":"Welcome grwat, R package hydrograph separation analysis based water level, temperature percipitation data. makes use geographic data processing spatially select temperature precipitation data within basin gauge, average data join element water level series. High-preformance Fortran/C++ computation used hydrograph processing separates water level series ground, seasonal, thaw, flood discharge. Interannual long-term characteristics discharge type derived. Results visualized form high-quality reports making use ggplot2 graphics knitr report generation","code":""},{"path":[]},{"path":"/index.html","id":"install-devtools","dir":"","previous_headings":"Installing","what":"Install devtools","title":"Hydrograph separation and analysis","text":"Currently package available GitHub repository. install GitHub, install devtools package first (unless already installed machine):","code":"install.packages(\"devtools\")"},{"path":[]},{"path":"/index.html","id":"binary-r-41-only","dir":"","previous_headings":"Installing > Install grwat","what":"Binary (R 4.1 only)","title":"Hydrograph separation and analysis","text":"R 4.1 installed, easiest way install Windows macOS use compiled binary package. Windows: macOS:","code":"devtools::install_url('https://tsamsonov.github.io/grwat/build/grwat.zip',                        build = FALSE, dependencies = TRUE) devtools::install_url('https://tsamsonov.github.io/grwat/build/grwat.tgz',                        build = FALSE, dependencies = TRUE)"},{"path":"/index.html","id":"from-sources","dir":"","previous_headings":"Installing > Install grwat","what":"From sources","title":"Hydrograph separation and analysis","text":"Since grwat contains C++ code, needs compiled package installation. Linux users compiler already installed system. macOS users : Install Xcode command-line tools. Restart R session. Windows users : Install Rtools. Restart R session. previous steps completed successfully, grwat package can installed via single command:","code":"devtools::install_github(\"tsamsonov/grwat\")"},{"path":"/index.html","id":"funding","dir":"","previous_headings":"","what":"Funding","title":"Hydrograph separation and analysis","text":"grwat package developed financial support Russian Science Foundation (Project 19-77-10032). main separation algoritm developed 2016-2018 financial support RFBR (Project 16-35-60080). mountain block main separation algoritm developed 2018-2019 financial support Russian Science Foundation (Project 17-77-10169).","code":""},{"path":"/reference/gr_animate.html","id":null,"dir":"Reference","previous_headings":"","what":"Animate discharge through years — gr_animate","title":"Animate discharge through years — gr_animate","text":"Animate discharge years","code":""},{"path":"/reference/gr_animate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Animate discharge through years — gr_animate","text":"","code":"gr_animate(   df,   plot = TRUE,   file = NULL,   fps = 20,   kframes = 10,   width = 800,   height = 600,   locale = \"EN\" )"},{"path":"/reference/gr_animate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Animate discharge through years — gr_animate","text":"df data.frame date (1st) discharge (2nd) columns. locale String locale. Currently English locale supported. Defaults 'EN'.","code":""},{"path":"/reference/gr_animate.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Animate discharge through years — gr_animate","text":"return value gganimate::renderer() function","code":""},{"path":"/reference/gr_baseflow.html","id":null,"dir":"Reference","previous_headings":"","what":"Extracts baseflow for discharge — gr_baseflow","title":"Extracts baseflow for discharge — gr_baseflow","text":"Extracts baseflow discharge","code":""},{"path":"/reference/gr_baseflow.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extracts baseflow for discharge — gr_baseflow","text":"","code":"gr_baseflow(   Q,   a = 0.925,   k = 0.975,   C = 0.05,   aq = -0.5,   passes = 3,   padding = 30,   method = \"lynehollick\" )"},{"path":"/reference/gr_baseflow.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extracts baseflow for discharge — gr_baseflow","text":"Q daily discharge vector passes number filtering iterations. first iteration forward, second backward, third forward . Defaults 3 padding number elements padded beginning ending discharge vector reduce boundary effects method baseflow filtering method. Available methods \"maxwell\", \"boughton\", \"jakeman\", \"lynehollick\", \"chapman\". Default \"lynehollick\", corresponds Lyne-Hollick (1979) hydrograph separation method. alpha filtering parameter. Defaults 0.925","code":""},{"path":"/reference/gr_baseflow.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extracts baseflow for discharge — gr_baseflow","text":"baseflow vector","code":""},{"path":"/reference/gr_buffer_geo.html","id":null,"dir":"Reference","previous_headings":"","what":"Buffer sf objects in geographic coordinates through conic projection — gr_buffer_geo","title":"Buffer sf objects in geographic coordinates through conic projection — gr_buffer_geo","text":"Buffer sf objects geographic coordinates conic projection","code":""},{"path":"/reference/gr_buffer_geo.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Buffer sf objects in geographic coordinates through conic projection — gr_buffer_geo","text":"","code":"gr_buffer_geo(g, bufsize)"},{"path":"/reference/gr_buffer_geo.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Buffer sf objects in geographic coordinates through conic projection — gr_buffer_geo","text":"g sf sfg object geographic coordinates bufsize double. Size buffer, metres","code":""},{"path":"/reference/gr_buffer_geo.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Buffer sf objects in geographic coordinates through conic projection — gr_buffer_geo","text":"sf sfg object, buffered bufsize distance","code":""},{"path":"/reference/gr_buffer_geo.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Buffer sf objects in geographic coordinates through conic projection — gr_buffer_geo","text":"","code":"if (FALSE) { gr_buffer_geo(basin, 50000) }"},{"path":"/reference/gr_check_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Check the correctness of data frame for separating — gr_check_data","title":"Check the correctness of data frame for separating — gr_check_data","text":"Check correctness data frame separating","code":""},{"path":"/reference/gr_check_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check the correctness of data frame for separating — gr_check_data","text":"","code":"gr_check_data(df)"},{"path":"/reference/gr_check_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check the correctness of data frame for separating — gr_check_data","text":"df","code":""},{"path":[]},{"path":[]},{"path":"/reference/gr_check_params.html","id":null,"dir":"Reference","previous_headings":"","what":"Check the correctness of parameters list for separating — gr_check_params","title":"Check the correctness of parameters list for separating — gr_check_params","text":"Check correctness parameters list separating","code":""},{"path":"/reference/gr_check_params.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check the correctness of parameters list for separating — gr_check_params","text":"","code":"gr_check_params(params)"},{"path":"/reference/gr_check_params.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check the correctness of parameters list for separating — gr_check_params","text":"params list separation parameters, returned gr_get_params() function","code":""},{"path":"/reference/gr_check_params.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check the correctness of parameters list for separating — gr_check_params","text":"stops execution anything wrong prints exact reason error. Otherwise prins message everything OK","code":""},{"path":"/reference/gr_fill_gaps.html","id":null,"dir":"Reference","previous_headings":"","what":"Fill missing water discharge data using linear interpolation — gr_fill_gaps","title":"Fill missing water discharge data using linear interpolation — gr_fill_gaps","text":"Fill missing water discharge data using linear interpolation","code":""},{"path":"/reference/gr_fill_gaps.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fill missing water discharge data using linear interpolation — gr_fill_gaps","text":"","code":"gr_fill_gaps(hdata, autocorr = 0.7, nobserv = NULL)"},{"path":"/reference/gr_fill_gaps.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fill missing water discharge data using linear interpolation — gr_fill_gaps","text":"hdata Water discharge series. Data frame containing 4 columns: year (YYYY), montth (MM), day (DD) level (water level) autocorr Autocorrelation value defines possible length period. Defaults 0.7.  nobserv parameter set, parameter ignored. parameters NULL, gaps filled disregard lengths (recommended). nobserv Maximum number contiguous observations can filled. Defaults NULL. parameter set user, autocorr parameter ignored. parameters NULL, gaps filled disregard lengths (recommended). expand algorithm insert missing dates? dates  order","code":""},{"path":"/reference/gr_fill_gaps.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fill missing water discharge data using linear interpolation — gr_fill_gaps","text":"filled discharge values","code":""},{"path":"/reference/gr_get_gaps.html","id":null,"dir":"Reference","previous_headings":"","what":"Get gaps in the data — gr_get_gaps","title":"Get gaps in the data — gr_get_gaps","text":"Get gaps data","code":""},{"path":"/reference/gr_get_gaps.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get gaps in the data — gr_get_gaps","text":"","code":"gr_get_gaps(hdata)"},{"path":"/reference/gr_get_gaps.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get gaps in the data — gr_get_gaps","text":"hdata data frame first column date, second column discharge value","code":""},{"path":"/reference/gr_get_gaps.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get gaps in the data — gr_get_gaps","text":"data frame periods data periods gaps","code":""},{"path":"/reference/gr_get_params.html","id":null,"dir":"Reference","previous_headings":"","what":"Get default separation parameters for selected region — gr_get_params","title":"Get default separation parameters for selected region — gr_get_params","text":"Get default separation parameters selected region","code":""},{"path":"/reference/gr_get_params.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get default separation parameters for selected region — gr_get_params","text":"","code":"gr_get_params(reg = \"Midplain\")"},{"path":"/reference/gr_get_params.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get default separation parameters for selected region — gr_get_params","text":"reg Name region","code":""},{"path":[]},{"path":"/reference/gr_help_params.html","id":null,"dir":"Reference","previous_headings":"","what":"Get the information about parameters used to separate the hydrograph — gr_help_params","title":"Get the information about parameters used to separate the hydrograph — gr_help_params","text":"Get information parameters used separate hydrograph","code":""},{"path":"/reference/gr_help_params.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get the information about parameters used to separate the hydrograph — gr_help_params","text":"","code":"gr_help_params()"},{"path":"/reference/gr_help_params.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get the information about parameters used to separate the hydrograph — gr_help_params","text":"table parameter names","code":""},{"path":"/reference/gr_help_vars.html","id":null,"dir":"Reference","previous_headings":"","what":"Get hydrograph parameters list — gr_help_vars","title":"Get hydrograph parameters list — gr_help_vars","text":"Get hydrograph parameters list","code":""},{"path":"/reference/gr_help_vars.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get hydrograph parameters list — gr_help_vars","text":"","code":"gr_help_vars()"},{"path":"/reference/gr_help_vars.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get hydrograph parameters list — gr_help_vars","text":"data.frame parameters","code":""},{"path":"/reference/gr_help_vars.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get hydrograph parameters list — gr_help_vars","text":"","code":"grwat::gr_help_vars() #> # A tibble: 57 × 19 #>       ID Position Width Source Name   Units Unitsen Readtype Type   Test Desc    #>    <dbl>    <dbl> <dbl>  <dbl> <chr>  <chr> <chr>   <chr>    <chr> <dbl> <chr>   #>  1     1        1     7      1 year_… NA    NA      integer  inte…     0 Номер … #>  2     2        8    10      1 Year1  Год   Year    integer  inte…     0 Год, к… #>  3     3       18    10      1 Year2  Год   Year    integer  inte…     0 Год, к… #>  4     4       28    15      1 dates… Дата  Date    Date     Date      1 Дата н… #>  5     5       43    15      1 datep… Дата  Date    Date     Date      1 Дата о… #>  6    57        0     0      0 PolPr… Дней  Days    integer  inte…     1 Продол… #>  7     6       58    10      1 Qy     м^3/с m^3/s   double   doub…     1 Средни… #>  8     7       68    10      1 Qmax   м^3/с m^3/s   double   doub…     1 Максим… #>  9     8       78    15      1 datem… Дата  Date    Date     Date      1 Дата м… #> 10     9       93    10      1 Qygr   м^3/с m^3/s   double   doub…     1 Средни… #> # … with 47 more rows, and 8 more variables: Descen <chr>, Group <chr>, #> #   Winter <dbl>, Chart <chr>, Color <chr>, Order <dbl>, Range <chr>, #> #   Problems <chr>"},{"path":"/reference/gr_join_rean.html","id":null,"dir":"Reference","previous_headings":"","what":"Join grwat reanalysis to hydrological level series — gr_join_rean","title":"Join grwat reanalysis to hydrological level series — gr_join_rean","text":"Join grwat reanalysis hydrological level series","code":""},{"path":"/reference/gr_join_rean.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Join grwat reanalysis to hydrological level series — gr_join_rean","text":"","code":"gr_join_rean(hdata, rean, buffer)"},{"path":"/reference/gr_join_rean.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Join grwat reanalysis to hydrological level series — gr_join_rean","text":"hdata data frame containing 2 columns: date discharge level rean List. Contains three components: days series, values location points buffer Region select reanalysis data","code":""},{"path":"/reference/gr_join_rean.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Join grwat reanalysis to hydrological level series — gr_join_rean","text":"List two components: water level table enriched reanalysis data selected points","code":""},{"path":"/reference/gr_join_rean.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Join grwat reanalysis to hydrological level series — gr_join_rean","text":"","code":"if (FALSE) { grwat::process(hdata, rean, buffer) }"},{"path":"/reference/gr_kable_tests.html","id":null,"dir":"Reference","previous_headings":"","what":"Kable p-values table by coloring it using green-yellow-red palette — gr_kable_tests","title":"Kable p-values table by coloring it using green-yellow-red palette — gr_kable_tests","text":"Kable p-values table coloring using green-yellow-red palette","code":""},{"path":"/reference/gr_kable_tests.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Kable p-values table by coloring it using green-yellow-red palette — gr_kable_tests","text":"","code":"gr_kable_tests(tests, locale = \"EN\", format = \"latex\")"},{"path":"/reference/gr_kable_tests.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Kable p-values table by coloring it using green-yellow-red palette — gr_kable_tests","text":"tests Test result returned test_variables() function locale character string. Currently English ('EN') Russian ('RU') locales supported HTML output. PDF always rendered English format character string. Currently 'latex' 'html' supported","code":""},{"path":"/reference/gr_kable_tests.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Kable p-values table by coloring it using green-yellow-red palette — gr_kable_tests","text":"kabled version p-values table coloured","code":""},{"path":"/reference/gr_mamba.html","id":null,"dir":"Reference","previous_headings":"","what":"Just mamba — gr_mamba","title":"Just mamba — gr_mamba","text":"Just mamba","code":""},{"path":"/reference/gr_mamba.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Just mamba — gr_mamba","text":"","code":"gr_mamba()"},{"path":"/reference/gr_mamba.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Just mamba — gr_mamba","text":"mamba","code":""},{"path":"/reference/gr_plot_acf.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot the autocorrelation function (ACF) for hydrograph time series — gr_plot_acf","title":"Plot the autocorrelation function (ACF) for hydrograph time series — gr_plot_acf","text":"Plot autocorrelation function (ACF) hydrograph time series","code":""},{"path":"/reference/gr_plot_acf.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot the autocorrelation function (ACF) for hydrograph time series — gr_plot_acf","text":"","code":"gr_plot_acf(hdata, autocorr = 0.7, max_lag = 30)"},{"path":"/reference/gr_plot_acf.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot the autocorrelation function (ACF) for hydrograph time series — gr_plot_acf","text":"hdata data.frame two columns: date discharge autocorr Numeric value autocorrelation time period highlighted.","code":""},{"path":"/reference/gr_plot_acf.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot the autocorrelation function (ACF) for hydrograph time series — gr_plot_acf","text":"ACF plot","code":""},{"path":"/reference/gr_plot_hori.html","id":null,"dir":"Reference","previous_headings":"","what":"A convenient wrapper around ggHoriPlot::geom_horizon() to visualize multiple river hydrogrphs at once — gr_plot_hori","title":"A convenient wrapper around ggHoriPlot::geom_horizon() to visualize multiple river hydrogrphs at once — gr_plot_hori","text":"convenient wrapper around ggHoriPlot::geom_horizon() visualize multiple river hydrogrphs ","code":""},{"path":"/reference/gr_plot_hori.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A convenient wrapper around ggHoriPlot::geom_horizon() to visualize multiple river hydrogrphs at once — gr_plot_hori","text":"","code":"gr_plot_hori(df, years, pal = \"YlGnBu\", rev = T, scale = 6, locale = \"EN\")"},{"path":"/reference/gr_plot_hori.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"A convenient wrapper around ggHoriPlot::geom_horizon() to visualize multiple river hydrogrphs at once — gr_plot_hori","text":"df data.frame date (1st) discharge (2nd) columns. years Integer vector years plotted. pal Numeric character string. Color palette identifier passed ggplot2::scale_fill_distiller() rev Boolean. Reverse palette? scale Numeric. Scale factor passed ggHoriPlot::geom_horizon(). Defaults 0.01. locale String locale. Currently English locale supported. Defaults 'EN'.","code":""},{"path":"/reference/gr_plot_hori.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"A convenient wrapper around ggHoriPlot::geom_horizon() to visualize multiple river hydrogrphs at once — gr_plot_hori","text":"ggplot2 object","code":""},{"path":"/reference/gr_plot_matrix.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot discharge value, source and season via raster-based visualization through years — gr_plot_matrix","title":"Plot discharge value, source and season via raster-based visualization through years — gr_plot_matrix","text":"Plot discharge value, source season via raster-based visualization years","code":""},{"path":"/reference/gr_plot_matrix.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot discharge value, source and season via raster-based visualization through years — gr_plot_matrix","text":"","code":"gr_plot_matrix(df, years = NULL, type = \"value\", locale = \"EN\")"},{"path":"/reference/gr_plot_matrix.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot discharge value, source and season via raster-based visualization through years — gr_plot_matrix","text":"df Hydrograph separation data.frame produced gr_separate(). years Integer vector years plotted. type String. Supported options 'value', 'components', 'season'. Defaults 'value' locale String locale. Currently English locale supported. Defaults 'EN'.","code":""},{"path":"/reference/gr_plot_matrix.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot discharge value, source and season via raster-based visualization through years — gr_plot_matrix","text":"ggplot2 object","code":""},{"path":"/reference/gr_plot_minmonth.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot histogram of minimum discharge month for two periods — gr_plot_minmonth","title":"Plot histogram of minimum discharge month for two periods — gr_plot_minmonth","text":"Plot histogram minimum discharge month two periods","code":""},{"path":"/reference/gr_plot_minmonth.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot histogram of minimum discharge month for two periods — gr_plot_minmonth","text":"","code":"gr_plot_minmonth(   df,   year = NULL,   exclude = NULL,   tests = NULL,   pagebreak = FALSE,   locale = \"EN\" )"},{"path":"/reference/gr_plot_minmonth.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot histogram of minimum discharge month for two periods — gr_plot_minmonth","text":"df Hydrograph meteorological variables data.frame produced gr_summarize(). year Change year value separate two periods. exclude Integer vector years excluded plotting. locale String locale. Currently English locale supported. Defaults 'EN'.","code":""},{"path":"/reference/gr_plot_minmonth.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot histogram of minimum discharge month for two periods — gr_plot_minmonth","text":"ggplot2 objects","code":""},{"path":"/reference/gr_plot_periods.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot long-term changes of hydrograph variables for two periods — gr_plot_periods","title":"Plot long-term changes of hydrograph variables for two periods — gr_plot_periods","text":"Plot long-term changes hydrograph variables two periods","code":""},{"path":"/reference/gr_plot_periods.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot long-term changes of hydrograph variables for two periods — gr_plot_periods","text":"","code":"gr_plot_periods(   df,   ...,   year = NULL,   exclude = NULL,   tests = NULL,   layout = as.matrix(1),   pagebreak = FALSE,   locale = \"EN\" )"},{"path":"/reference/gr_plot_periods.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot long-term changes of hydrograph variables for two periods — gr_plot_periods","text":"df Hydrograph meteorological variables data.frame produced gr_summarize() ... Quoted sequence variable names year Integer. Change year value separate two periods (overridden tests supplied) exclude Integer vector years excluded plotting tests Tests list variables (generated test_variables() function) layout Layout matrix pagebreak Logical. Whether break page plots (needed reporting). Defaults FALSE locale String locale. Currently English locale supported. Defaults 'EN'.","code":""},{"path":"/reference/gr_plot_periods.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot long-term changes of hydrograph variables for two periods — gr_plot_periods","text":"ggplot2 objects","code":""},{"path":"/reference/gr_plot_ridge.html","id":null,"dir":"Reference","previous_headings":"","what":"A convenient wrapper around ggridges::geom_ridgeline() to visualize multiple river hydrogrphs at once — gr_plot_ridge","title":"A convenient wrapper around ggridges::geom_ridgeline() to visualize multiple river hydrogrphs at once — gr_plot_ridge","text":"convenient wrapper around ggridges::geom_ridgeline() visualize multiple river hydrogrphs ","code":""},{"path":"/reference/gr_plot_ridge.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A convenient wrapper around ggridges::geom_ridgeline() to visualize multiple river hydrogrphs at once — gr_plot_ridge","text":"","code":"gr_plot_ridge(   df,   years,   pal = 4,   rev = FALSE,   scale = 0.01,   alpha = 0.8,   locale = \"EN\" )"},{"path":"/reference/gr_plot_ridge.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"A convenient wrapper around ggridges::geom_ridgeline() to visualize multiple river hydrogrphs at once — gr_plot_ridge","text":"df data.frame date (1st) discharge (2nd) columns. years Integer vector years plotted. pal Numeric character string. Color palette identifier passed ggplot2::scale_fill_distiller() rev Boolean. Reverse palette? scale Numeric. Scale factor passed ggridges::geom_ridgeline(). Defaults 0.01. alpha Numeric. Opacity value ridgeline plot. Defaults 0.8 locale String locale. Currently English locale supported. Defaults 'EN'.","code":""},{"path":"/reference/gr_plot_ridge.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"A convenient wrapper around ggridges::geom_ridgeline() to visualize multiple river hydrogrphs at once — gr_plot_ridge","text":"ggplot2 object","code":""},{"path":"/reference/gr_plot_sep.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot hydrograph separation — gr_plot_sep","title":"Plot hydrograph separation — gr_plot_sep","text":"Plot hydrograph separation","code":""},{"path":"/reference/gr_plot_sep.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot hydrograph separation — gr_plot_sep","text":"","code":"gr_plot_sep(   df,   years = NULL,   layout = as.matrix(1),   pagebreak = FALSE,   locale = \"EN\",   prec = FALSE,   temp = FALSE,   span = 5 )"},{"path":"/reference/gr_plot_sep.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot hydrograph separation — gr_plot_sep","text":"df Hydrograph separation data.frame produced gr_separate(). years Integer vector years plotted. layout Layout matrix. pagebreak Logical. Whether break page plots (needed reporting). Defaults FALSE. locale String locale. Currently English locale supported. Defaults 'EN'. prec Boolean. Add precipitation curve plot? Defaults FALSE. temp Boolean. Add temperature curve plot? Defaults FALSE.","code":""},{"path":"/reference/gr_plot_sep.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot hydrograph separation — gr_plot_sep","text":"ggplot2 objects","code":""},{"path":"/reference/gr_plot_tests.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot change year density — gr_plot_tests","title":"Plot change year density — gr_plot_tests","text":"Plot change year density","code":""},{"path":"/reference/gr_plot_tests.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot change year density — gr_plot_tests","text":"","code":"gr_plot_tests(tests, locale = \"EN\")"},{"path":"/reference/gr_plot_tests.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot change year density — gr_plot_tests","text":"tests List tests generated test_variables() locale String locale. Currently English locale supported. Defaults 'EN'.","code":""},{"path":"/reference/gr_plot_tests.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot change year density — gr_plot_tests","text":"plots density plot change year","code":""},{"path":"/reference/gr_plot_vars.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot interannual parameters — gr_plot_vars","title":"Plot interannual parameters — gr_plot_vars","text":"Plot interannual parameters","code":""},{"path":"/reference/gr_plot_vars.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot interannual parameters — gr_plot_vars","text":"","code":"gr_plot_vars(   df,   ...,   tests = NULL,   exclude = NULL,   smooth = TRUE,   layout = as.matrix(1),   pagebreak = FALSE,   locale = \"EN\" )"},{"path":"/reference/gr_plot_vars.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot interannual parameters — gr_plot_vars","text":"df Hydrograph meteorological variables data.frame produced gr_summarize(). ... Quoted sequence variable names. tests Tests list variables (generated test_variables() function). exclude Integer vector years excluded plotting. smooth Logical. true local smoothing regression plotted. Defaults TRUE. layout Layout matrix. pagebreak Logical. Whether break page plots (needed reporting). Defaults FALSE. locale String locale. Currently English locale supported. Defaults 'EN'.","code":""},{"path":[]},{"path":"/reference/gr_read_rean.html","id":null,"dir":"Reference","previous_headings":"","what":"Read grwat daily reanalysis — gr_read_rean","title":"Read grwat daily reanalysis — gr_read_rean","text":"Read grwat daily reanalysis","code":""},{"path":"/reference/gr_read_rean.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Read grwat daily reanalysis — gr_read_rean","text":"","code":"gr_read_rean(file_prec, file_temp)"},{"path":"/reference/gr_read_rean.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Read grwat daily reanalysis — gr_read_rean","text":"file_prec Precipitation NetCDF file file_temp Temperature NetCDF file","code":""},{"path":"/reference/gr_read_rean.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Read grwat daily reanalysis — gr_read_rean","text":"List containing time series, precipitation series, temperature series spatial points (sf)","code":""},{"path":"/reference/gr_read_rean.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Read grwat daily reanalysis — gr_read_rean","text":"","code":"if (FALSE) { grwat::read_interim(\"rean/prec.nc\", \"rean/temp.nc\") }"},{"path":"/reference/gr_report.html","id":null,"dir":"Reference","previous_headings":"","what":"Generates HTML report based on separation and variables — gr_report","title":"Generates HTML report based on separation and variables — gr_report","text":"Generates HTML report based separation variables","code":""},{"path":"/reference/gr_report.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generates HTML report based on separation and variables — gr_report","text":"","code":"gr_report(   sep,   vars,   output = \"Report.html\",   year = NULL,   exclude = NULL,   prec = FALSE,   temp = FALSE,   span = 5,   locale = \"EN\" )"},{"path":"/reference/gr_report.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generates HTML report based on separation and variables — gr_report","text":"sep  vars  output  year  exclude  locale","code":""},{"path":[]},{"path":"/reference/gr_separate.html","id":null,"dir":"Reference","previous_headings":"","what":"Advanced hydrograph separation — gr_separate","title":"Advanced hydrograph separation — gr_separate","text":"Separates hydrograph genetic components: groundwater, thaw, flood seasonal (freshet) flood.","code":""},{"path":"/reference/gr_separate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Advanced hydrograph separation — gr_separate","text":"","code":"gr_separate(df, params = gr_get_params())"},{"path":"/reference/gr_separate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Advanced hydrograph separation — gr_separate","text":"df data.frame tibble four columns: date, discharge, temperature, precipitation params list separation parameters, returned gr_get_params() function","code":""},{"path":"/reference/gr_separate.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Advanced hydrograph separation — gr_separate","text":"data.frame 12 columns:","code":""},{"path":"/reference/gr_separate.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Advanced hydrograph separation — gr_separate","text":"","code":"library(grwat) print(spas) # example Spas-Zagorye data loaded with grwat package #> # A tibble: 23,742 × 4 #>    Date           Q   Temp  Prec #>    <date>     <dbl>  <dbl> <dbl> #>  1 1956-01-01  5.18  -6.46 0.453 #>  2 1956-01-02  5.18 -11.4  0.825 #>  3 1956-01-03  5.44 -10.7  0.26  #>  4 1956-01-04  5.44  -8.05 0.397 #>  5 1956-01-05  5.44 -11.7  0.102 #>  6 1956-01-06  5.58 -20.1  0.032 #>  7 1956-01-07  5.58 -16.6  0.024 #>  8 1956-01-08  5.36 -15.2  0.042 #>  9 1956-01-09  5.36 -15.9  0.053 #> 10 1956-01-10  5.31 -13.3  0.08  #> # … with 23,732 more rows  sep = gr_separate(spas, params = gr_get_params(reg = 'Midplain')) #> grwat:  parameters list and types are OK #> Error in rename(., Date = 1): could not find function \"rename\" dplyr::filter(sep, Year == 2010) # View water resources year #> Error in dplyr::filter(sep, Year == 2010): object 'sep' not found gr_plot_sep(sep, 2010) # Plot separation #> Error in dplyr::mutate(., Year = lubridate::year(Date)): object 'sep' not found"},{"path":"/reference/gr_set_params.html","id":null,"dir":"Reference","previous_headings":"","what":"Change separation parameters through graphical interface — gr_set_params","title":"Change separation parameters through graphical interface — gr_set_params","text":"Change separation parameters graphical interface","code":""},{"path":"/reference/gr_set_params.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Change separation parameters through graphical interface — gr_set_params","text":"","code":"gr_set_params(params)"},{"path":"/reference/gr_set_params.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Change separation parameters through graphical interface — gr_set_params","text":"params Parameters list","code":""},{"path":[]},{"path":"/reference/gr_summarize.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate various summary stats for separated hydrograph — gr_summarize","title":"Calculate various summary stats for separated hydrograph — gr_summarize","text":"Calculate various summary stats separated hydrograph","code":""},{"path":"/reference/gr_summarize.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate various summary stats for separated hydrograph — gr_summarize","text":"","code":"gr_summarize(tab)"},{"path":"/reference/gr_summarize.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate various summary stats for separated hydrograph — gr_summarize","text":"tab data frame resulting separate() function","code":""},{"path":"/reference/gr_summarize.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate various summary stats for separated hydrograph — gr_summarize","text":"data frame one row water-resources year multiple columns statistics","code":""},{"path":"/reference/gr_test_vars.html","id":null,"dir":"Reference","previous_headings":"","what":"Run various tests on interannual characteristics.\nRequired number of observations for various tests:\nPettitt > 0, Mann.Kendall > 2, Theil-Sen slope > 1, Student > 1, — gr_test_vars","title":"Run various tests on interannual characteristics.\nRequired number of observations for various tests:\nPettitt > 0, Mann.Kendall > 2, Theil-Sen slope > 1, Student > 1, — gr_test_vars","text":"Run various tests interannual characteristics. Required number observations various tests: Pettitt > 0, Mann.Kendall > 2, Theil-Sen slope > 1, Student > 1,","code":""},{"path":"/reference/gr_test_vars.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run various tests on interannual characteristics.\nRequired number of observations for various tests:\nPettitt > 0, Mann.Kendall > 2, Theil-Sen slope > 1, Student > 1, — gr_test_vars","text":"","code":"gr_test_vars(df, ..., year = NULL, exclude = NULL, locale = \"EN\")"},{"path":"/reference/gr_test_vars.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run various tests on interannual characteristics.\nRequired number of observations for various tests:\nPettitt > 0, Mann.Kendall > 2, Theil-Sen slope > 1, Student > 1, — gr_test_vars","text":"df data.frame produced separation function ... fields (quoted) year fixed year value long-term changes estimation exclude integer vector. vector years excluded tests locale locale p-value table","code":""},{"path":"/reference/gr_test_vars.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run various tests on interannual characteristics.\nRequired number of observations for various tests:\nPettitt > 0, Mann.Kendall > 2, Theil-Sen slope > 1, Student > 1, — gr_test_vars","text":"List testing results","code":""},{"path":"/reference/pipe.html","id":null,"dir":"Reference","previous_headings":"","what":"Pipe operator — %>%","title":"Pipe operator — %>%","text":"See magrittr::%>% details.","code":""},{"path":"/reference/pipe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pipe operator — %>%","text":"","code":"lhs %>% rhs"},{"path":"/reference/pipe.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Pipe operator — %>%","text":"lhs value magrittr placeholder. rhs function call using magrittr semantics.","code":""},{"path":"/reference/pipe.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Pipe operator — %>%","text":"result calling rhs(lhs).","code":""}]
