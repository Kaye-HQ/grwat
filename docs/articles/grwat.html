<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to grwat R package • grwat</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to grwat R package">
<meta property="og:description" content="grwat">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">grwat</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/grwat.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/scale-space.html">Scale space hydrograph analysis</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/tsamsonov/grwat/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="grwat_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introduction to grwat R package</h1>
                        <h4 class="author">Timofey Samsonov</h4>
            
            <h4 class="date">2020-08-06</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/tsamsonov/grwat/blob/master/vignettes/grwat.Rmd"><code>vignettes/grwat.Rmd</code></a></small>
      <div class="hidden name"><code>grwat.Rmd</code></div>

    </div>

    
    
<p><strong>grwat</strong> is an R package for automated multi-year hydrograph analysis that provides functions to</p>
<ol style="list-style-type: decimal">
<li>Preprocess hydrological data to enrich them with meteorological variables.</li>
<li>Separate hydrograph into ground, seasonal, thaw and rain discharge.</li>
<li>Describe obtained separation with multiple variables.</li>
<li>Perform statistical tests on hydrograph variables.</li>
<li>Plot interannual and long-term changes of hydrograph variables.</li>
<li>Generate high-quality report files containing the full information gained during analysis.</li>
</ol>
<p>This vignette contains a brief introduction to solving all these tasks with grwat.</p>
<div id="preprocess" class="section level1">
<h1 class="hasAnchor">
<a href="#preprocess" class="anchor"></a>Preprocess</h1>
<p>Preprocessing joins reanalysis data to raw hydrological data on time and geographic location. It can be made using grwat in three regimes: manual, gauge folder processing and basins folder processing.</p>
<div id="manual-preprocessing" class="section level2">
<h2 class="hasAnchor">
<a href="#manual-preprocessing" class="anchor"></a>Manual preprocessing</h2>
<p>You can join reanalysis and water level data for a single gauge as follows:</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">sf</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">grwat</span>)

<span class="no">wd</span> <span class="kw">=</span> <span class="st">"/Volumes/Work/_grwat/Mezen_Malonisog/"</span>

<span class="fu"><a href="https://rdrr.io/r/base/getwd.html">setwd</a></span>(<span class="no">wd</span>)

<span class="no">hdata</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span>(<span class="st">'in_Mezen_Malonisog.txt'</span>,
                 <span class="kw">header</span> <span class="kw">=</span> <span class="fl">FALSE</span>,
                 <span class="kw">sep</span> <span class="kw">=</span> <span class="st">' '</span>) <span class="co"># read gauge data</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">hdata</span>)
<span class="co">#&gt;   V1 V2   V3  V4</span>
<span class="co">#&gt; 1 11  5 1945 142</span>
<span class="co">#&gt; 2 12  5 1945 146</span>
<span class="co">#&gt; 3 13  5 1945 148</span>
<span class="co">#&gt; 4 14  5 1945 158</span>
<span class="co">#&gt; 5 15  5 1945 175</span>
<span class="co">#&gt; 6 16  5 1945 212</span>

<span class="no">basin</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/sf/man/st_read.html">st_read</a></span>(<span class="st">'Mezen_Malonisog.gpkg'</span>, <span class="kw">quiet</span> <span class="kw">=</span> <span class="fl">TRUE</span>) <span class="co"># read basin region</span>
<span class="no">basin_pr</span> <span class="kw">=</span> <span class="kw pkg">grwat</span><span class="kw ns">::</span><span class="fu"><a href="../reference/st_buffer_geo.html">st_buffer_geo</a></span>(<span class="no">basin</span>, <span class="fl">50000</span>)  <span class="co"># buffer region by 50 km</span>

<span class="no">rean</span> <span class="kw">=</span> <span class="kw pkg">grwat</span><span class="kw ns">::</span><span class="fu"><a href="../reference/read_interim.html">read_interim</a></span>(<span class="st">'prec.nc'</span>, <span class="st">'temp.nc'</span>) <span class="co"># read reanalysis data</span>
<span class="no">hdata_rean</span> <span class="kw">=</span> <span class="kw pkg">grwat</span><span class="kw ns">::</span><span class="fu"><a href="../reference/join_interim.html">join_interim</a></span>(<span class="no">hdata</span>, <span class="no">rean</span>, <span class="no">basin_pr</span>) <span class="co"># join reanalysis data to hydrological series</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">hdata_rean</span>$<span class="no">df</span>)
<span class="co">#&gt;       N    Y M  D     T     P   L</span>
<span class="co">#&gt; 1 23872 1945 5 11 -3.61 1.081 142</span>
<span class="co">#&gt; 2 23873 1945 5 12 -0.41 3.266 146</span>
<span class="co">#&gt; 3 23874 1945 5 13 -0.05 5.723 148</span>
<span class="co">#&gt; 4 23875 1945 5 14 -0.19 1.774 158</span>
<span class="co">#&gt; 5 23876 1945 5 15 -0.26 1.690 175</span>
<span class="co">#&gt; 6 23877 1945 5 16 -0.89 1.648 212</span></pre></body></html></div>
<p>After reanalysis data are joined you can easily plot a map of the derived spatial configuration with</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="kw pkg">grwat</span><span class="kw ns">::</span><span class="fu"><a href="../reference/map.html">map</a></span>(<span class="no">rean</span>$<span class="no">pts</span>, <span class="no">hdata_rean</span>$<span class="no">pts</span>, <span class="no">basin</span>, <span class="no">basin_pr</span>) <span class="co"># plot spatial configuration</span></pre></body></html></div>
<p><img src="grwat_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
</div>
<div id="gauge-folder" class="section level2">
<h2 class="hasAnchor">
<a href="#gauge-folder" class="anchor"></a>Gauge folder</h2>
<p>Grwat can preprocess hydrological data that is inside one gauge folder. That folder should contain <strong>two</strong> files:</p>
<ul>
<li>Text file with hydrological data in CSV format, space-separated (<code>.txt</code> extension)</li>
<li>Spatial data file with polygon of a gauge watershed area in Geopackage (<code>.gpkg</code> extension) or Shapefile (<code>.shp</code> extension) format</li>
</ul>
<p>The name of the file is not restricted, only the extension and the format. Here is an example:</p>
<p><img src="in_gauge.png"></p>
<p>Reanalysis data should be read before using <code><a href="../reference/read_interim.html">read_interim()</a></code> function from grwat package. Having these prerequisities satisfied, the command is:</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="kw pkg">grwat</span><span class="kw ns">::</span><span class="fu"><a href="../reference/process_gauge.html">process_gauge</a></span>(<span class="no">wd</span>, <span class="no">rean</span>, <span class="kw">bufsize</span> <span class="kw">=</span> <span class="fl">50000</span>) <span class="co"># process single folder</span></pre></body></html></div>
<p>The value returned by this function is a number of reanalysis points extracted by buffered basin region. As a result of the execution of this function the folder receives two enriched data files and a map of the spatial configuration:</p>
<p><img src="out_gauge.png"></p>
<blockquote>
<p>We recommend using GeoPackage because it is fast and powerful <a href="https://www.geopackage.org">OGC-standardized</a> modern spatial data format that does not include any sidecar files like Esri Shapefile. You can easily convert many spatial data formats to GeoPackage by <a href="https://www.qgis.org/">QGIS</a> <em>Export &gt; Save as…</em> command in a layer context menu, using <code>st_read</code> and then <code>st_write</code> functions from <a href="https://r-spatial.github.io/sf/"><code>sf</code></a> R package, or via <a href="http://www.gdal.org">GDAL</a> utils if you prefer command line or need batch processing (which can also be automated in R). Note that if you use Shapefile format for basin border representation, you should also preserve <code>.dbf</code> and <code>.shx</code> sidecar files that store attribute information and relation between attributes and geometry. Otherwise the shapefile cannot be read correctly.</p>
</blockquote>
</div>
<div id="basins-folder" class="section level2">
<h2 class="hasAnchor">
<a href="#basins-folder" class="anchor"></a>Basins folder</h2>
<p>Basins mode provides automation of reanalysis data joining across multiple basins and gauges. It is based on a fixed folder structure that should be organized by user. This structure is:</p>
<ol style="list-style-type: decimal">
<li>The top-level folder specified by user must contain only one folder, which is called <strong>in</strong>.</li>
<li>This <strong>in</strong> folder contains an arbitrary number of folders (at least one), each of those corresponding to a single river <strong>basin</strong>.</li>
<li>Each river basin folder contains an arbitrary number of folders (at least one), each of those corresponding to a single river <strong>gauge</strong>.</li>
<li>Each gauge folder contains strictly two files: a <code>.txt</code> file with hydrological data, and <code>.gpkg</code> or <code>.shp</code> file with polygon of a gauge watershed area.</li>
</ol>
<p>The names of basin and gauge folders are not restricted, but we highly recommend begin with a letter and proceed with alphanumerical symbols, underscore and a hyphen from ASCII encoding (<code>a-z, A-Z, 0-9, _, -</code>)</p>
<p>An example of specified directory structure is provided in the picture below:</p>
<p><img src="in_folder.png"></p>
<p>The processing of this folder structure is performed by <code><a href="../reference/process_basins.html">process_basins()</a></code> function:</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="no">wd</span> <span class="kw">=</span> <span class="st">"/Volumes/Work/_grwat/2018/"</span>
<span class="kw pkg">grwat</span><span class="kw ns">::</span><span class="fu"><a href="../reference/process_basins.html">process_basins</a></span>(<span class="no">wd</span>, <span class="no">rean</span>, <span class="kw">bufsize</span> <span class="kw">=</span> <span class="fl">50000</span>) <span class="co"># process single folder</span></pre></body></html></div>
<p>It works in a following way:</p>
<ol style="list-style-type: decimal">
<li><p><code><a href="../reference/process_basins.html">process_basins()</a></code> takes <strong>in</strong> folder inside folder specified by <code>wd</code> parameter and copies its content to a new <strong>out</strong> folder in the same directory. All the following procedures are executed inside <strong>out</strong> folder, which allows easy removal of results and rexecution of the processing if some parameters should be changed.</p></li>
<li><p>Every gauge folder is processed using <code><a href="../reference/process_gauge.html">process_gauge()</a></code> function which produces enriched data files and a map inside each gauge folder.</p></li>
<li>
<p><code><a href="../reference/process_basins.html">process_basins()</a></code> also produces <em>summary.txt</em> files inside each basin folder and one <em>summary.txt</em> file directly in <strong>out</strong> folder. These files contain a number of reanalysis points for each gauge’s watershed. These are two special cases:</p>
<ul>
<li>0 means that no reanalysis data are found inside a watershed</li>
<li>-1 means that there were problems either reading <code>.txt</code> or <code>.gpkg</code>/<code>.shp</code> file</li>
</ul>
<p>In both cases the corresponding gauge folder will not contain any new files inside, and the further exploration of the problem should be taken by user. 0 means that the watershed is located outside the extent of reanalysis data or it is too small in comparison with spatial sampling of reanalysis data. Try increasing buffer size. -1 means that there are problems with your input files, and solution depends on the exact case (you must diagnose the reasons by yourself).</p>
</li>
</ol>
<p>An example of resulting directory structure is provided in the picture below:</p>
<p><img src="out_folder.png"></p>
</div>
</div>
<div id="separate" class="section level1">
<h1 class="hasAnchor">
<a href="#separate" class="anchor"></a>Separate and describe</h1>
<p>Currently separation and description procedures are unavalable inside grwat package and are performed using external command-line Fortran<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> program that produces two files:</p>
<ul>
<li>
<em>AllGrWat.txt</em> contains hydrograph separation data</li>
<li>
<em>Total.txt</em> contains multiple variables describing the separated hydrograph</li>
</ul>
<p>These output data can be visualised and statistically assessed by grwat functions that are uncovered in the next section.</p>
<p>We recommend placing these files in the same folder as processed data like in a picture below:</p>
<p><img src="sep_files.png"></p>
</div>
<div id="plot-and-test" class="section level1">
<h1 class="hasAnchor">
<a href="#plot-and-test" class="anchor"></a>Plot and test</h1>
<p>These functions from grwat package allow you to:</p>
<ul>
<li>Plot separation of hydrograph</li>
<li>Plot interannual changes of key water discharge variables</li>
<li>Plot long-term changes of key water discharge variables</li>
<li>Perform statistical tests on all calculated variables</li>
</ul>
<blockquote>
<p>Currently only English locale is provided in plots. In future releases Russian locale will also be added</p>
</blockquote>
<div id="plot-separation-of-hydrograph" class="section level2">
<h2 class="hasAnchor">
<a href="#plot-separation-of-hydrograph" class="anchor"></a>Plot separation of hydrograph</h2>
<p>To plot separation of hydrograph you need results of a separation procedure which are saved as <em>AllGrWat.txt</em> text file (see previous section). This file is read by <code><a href="../reference/read_separation.html">read_separation()</a></code> function:</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">setwd</a></span>(<span class="st">"/Volumes/Work/_grwat/Mezen_Malonisog/"</span>)

<span class="no">sep</span> <span class="kw">=</span> <span class="kw pkg">grwat</span><span class="kw ns">::</span><span class="fu"><a href="../reference/read_separation.html">read_separation</a></span>(<span class="st">'AllGrWat.txt'</span>)<span class="co">#</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">sep</span>)
<span class="co">#&gt; # A tibble: 6 x 8</span>
<span class="co">#&gt;   Date         Qin   Qgr  Qpol  Qpav Qthaw   Tin   Pin</span>
<span class="co">#&gt;   &lt;date&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1 1938-03-23  43.3  43.3   0       0     0  9999  9999</span>
<span class="co">#&gt; 2 1938-03-24  56.9  39.7  17.2     0     0  9999  9999</span>
<span class="co">#&gt; 3 1938-03-25  77.7  36.1  41.6     0     0  9999  9999</span>
<span class="co">#&gt; 4 1938-03-26 150    32.5 118.      0     0  9999  9999</span>
<span class="co">#&gt; 5 1938-03-27 334    28.9 305.      0     0  9999  9999</span>
<span class="co">#&gt; 6 1938-03-28 429    25.3 404.      0     0  9999  9999</span></pre></body></html></div>
<p>You can then plot separations for selected years using <code><a href="../reference/plot_separation.html">plot_separation()</a></code> function:</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="kw pkg">grwat</span><span class="kw ns">::</span><span class="fu"><a href="../reference/plot_separation.html">plot_separation</a></span>(<span class="no">sep</span>, <span class="fl">1978</span>) <span class="co"># plot single year</span></pre></body></html></div>
<p><img src="grwat_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="kw pkg">grwat</span><span class="kw ns">::</span><span class="fu"><a href="../reference/plot_separation.html">plot_separation</a></span>(<span class="no">sep</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1994</span>, <span class="fl">2001</span>)) <span class="co"># plot two years sequentially</span></pre></body></html></div>
<p><img src="grwat_files/figure-html/unnamed-chunk-7-2.png" width="700"><img src="grwat_files/figure-html/unnamed-chunk-7-3.png" width="700"></p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="kw pkg">grwat</span><span class="kw ns">::</span><span class="fu"><a href="../reference/plot_separation.html">plot_separation</a></span>(<span class="no">sep</span>, <span class="fl">1994</span>:<span class="fl">1997</span>, <span class="co"># plot four years on the same page</span>
                       <span class="kw">layout</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span>), <span class="kw">nrow</span><span class="kw">=</span><span class="fl">2</span>, <span class="kw">byrow</span><span class="kw">=</span><span class="fl">TRUE</span>))</pre></body></html></div>
<p><img src="grwat_files/figure-html/unnamed-chunk-7-4.png" width="700"></p>
</div>
<div id="read-and-test-hydrograph-variables" class="section level2">
<h2 class="hasAnchor">
<a href="#read-and-test-hydrograph-variables" class="anchor"></a>Read and test hydrograph variables</h2>
<p>Interannual changes of parameters are read from <em>Total.txt</em> file using <code><a href="../reference/read_variables.html">read_variables()</a></code> function:</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">setwd</a></span>(<span class="st">"/Volumes/Work/_grwat/Mezen_Malonisog/"</span>)

<span class="no">df</span> <span class="kw">=</span> <span class="kw pkg">grwat</span><span class="kw ns">::</span><span class="fu"><a href="../reference/read_variables.html">read_variables</a></span>(<span class="st">'Total.txt'</span>) <span class="co"># read parameters file</span>
<span class="co">#&gt; Warning: 3 failed to parse.</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">df</span>)
<span class="co">#&gt; # A tibble: 6 x 57</span>
<span class="co">#&gt;   year_number Year1 Year2 datestart  datepolend    Qy  Qmax datemax     Qygr</span>
<span class="co">#&gt;         &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;date&gt;     &lt;date&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;date&gt;     &lt;dbl&gt;</span>
<span class="co">#&gt; 1           1  1938  1939 2000-03-23 2000-06-08  98.1   747 2000-04-03  19.9</span>
<span class="co">#&gt; 2           2  1939  1940 2000-03-16 2000-07-11  66.9   487 2000-04-28  14.8</span>
<span class="co">#&gt; 3           3  1940  1941 2000-03-09 2000-07-12  97.4   995 2000-04-28  18.9</span>
<span class="co">#&gt; 4           4  1941  1942 2000-03-24 2000-07-21 214.   2030 2000-05-01  31.4</span>
<span class="co">#&gt; 5           5  1942  1943 2000-04-02 2000-07-31 242.   2790 2000-05-08  26.9</span>
<span class="co">#&gt; 6           6  1943  1944 2000-03-24 2000-06-15  71.3   451 2000-05-02  26.5</span>
<span class="co">#&gt; # … with 48 more variables: Qmmsummer &lt;dbl&gt;, monmmsummer &lt;date&gt;, Qmmwin &lt;dbl&gt;,</span>
<span class="co">#&gt; #   nommwin &lt;date&gt;, Q30s &lt;dbl&gt;, date30s1 &lt;date&gt;, date30s2 &lt;date&gt;, Q30w &lt;dbl&gt;,</span>
<span class="co">#&gt; #   date30w1 &lt;date&gt;, date30w2 &lt;date&gt;, Q10s &lt;dbl&gt;, date10s1 &lt;date&gt;,</span>
<span class="co">#&gt; #   date10s2 &lt;date&gt;, Q10w &lt;dbl&gt;, date10w1 &lt;date&gt;, date10w2 &lt;date&gt;, Q5s &lt;dbl&gt;,</span>
<span class="co">#&gt; #   date5s1 &lt;date&gt;, date5s2 &lt;date&gt;, Q5w &lt;dbl&gt;, date5w1 &lt;date&gt;, date5w2 &lt;date&gt;,</span>
<span class="co">#&gt; #   Wy &lt;dbl&gt;, Wgr &lt;dbl&gt;, Wpol1 &lt;dbl&gt;, Wpol2 &lt;dbl&gt;, Wpol3 &lt;dbl&gt;, Wpavs1 &lt;dbl&gt;,</span>
<span class="co">#&gt; #   Wpavs2 &lt;dbl&gt;, Wpavthaw1 &lt;dbl&gt;, Wpavthaw2 &lt;dbl&gt;, WgrS &lt;dbl&gt;, WS &lt;dbl&gt;,</span>
<span class="co">#&gt; #   WgrW &lt;dbl&gt;, WW &lt;dbl&gt;, Qmaxpavs &lt;dbl&gt;, datemaxpavs &lt;date&gt;,</span>
<span class="co">#&gt; #   Qmaxpavthaw &lt;dbl&gt;, datemaxpavthaw &lt;date&gt;, SumProd &lt;int&gt;, DaysPavsSum &lt;dbl&gt;,</span>
<span class="co">#&gt; #   WinProd &lt;int&gt;, DaysThawWin &lt;dbl&gt;, CvWin &lt;dbl&gt;, CvSum &lt;dbl&gt;,</span>
<span class="co">#&gt; #   CountPavs &lt;int&gt;, CountThaws &lt;int&gt;, PolProd &lt;int&gt;</span></pre></body></html></div>
<p>To get the detailed description of available variables you can invoke <code>get_parameters()</code>:</p>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="kw pkg">grwat</span><span class="kw ns">::</span><span class="fu"><a href="../reference/get_variables.html">get_variables</a></span>()
<span class="co">#&gt; # A tibble: 57 x 19</span>
<span class="co">#&gt;       ID Position Width Source Name  Units Unitsen Readtype Type   Test Desc </span>
<span class="co">#&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;    &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt;</span>
<span class="co">#&gt;  1     1        1     7      1 year… &lt;NA&gt;  &lt;NA&gt;    integer  inte…     0 Номе…</span>
<span class="co">#&gt;  2     2        8    10      1 Year1 Год   Year    integer  inte…     0 Год,…</span>
<span class="co">#&gt;  3     3       18    10      1 Year2 Год   Year    integer  inte…     0 Год,…</span>
<span class="co">#&gt;  4     4       28    15      1 date… Дата  Date    Date     Date      1 Дата…</span>
<span class="co">#&gt;  5     5       43    15      1 date… Дата  Date    Date     Date      1 Дата…</span>
<span class="co">#&gt;  6     6       58    10      1 Qy    м^3/с m^3/s   double   doub…     1 Сред…</span>
<span class="co">#&gt;  7     7       68    10      1 Qmax  м^3/с m^3/s   double   doub…     1 Макс…</span>
<span class="co">#&gt;  8     8       78    15      1 date… Дата  Date    Date     Date      1 Дата…</span>
<span class="co">#&gt;  9     9       93    10      1 Qygr  м^3/с m^3/s   double   doub…     1 Сред…</span>
<span class="co">#&gt; 10    10      103    10      1 Qmms… м^3/с m^3/s   double   doub…     1 Мини…</span>
<span class="co">#&gt; # … with 47 more rows, and 8 more variables: Descen &lt;chr&gt;, Group &lt;chr&gt;,</span>
<span class="co">#&gt; #   Winter &lt;dbl&gt;, Chart &lt;chr&gt;, Color &lt;chr&gt;, Order &lt;dbl&gt;, Range &lt;chr&gt;,</span>
<span class="co">#&gt; #   Problems &lt;chr&gt;</span></pre></body></html></div>
<p>Parameters can be statistically tested using <code><a href="../reference/test_variables.html">test_variables(df, ..., year = NULL, locale='EN')</a></code> function. Names of the parameters are passed comma-separated in place of <code>...</code>. They are quoted, so you do not need to pass them as character strings, just write their names:</p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="kw pkg">grwat</span><span class="kw ns">::</span><span class="fu"><a href="../reference/test_variables.html">test_variables</a></span>(<span class="no">df</span>, <span class="no">Qmax</span>)
<span class="co">#&gt; Warning: `select_()` is deprecated as of dplyr 0.7.0.</span>
<span class="co">#&gt; Please use `select()` instead.</span>
<span class="co">#&gt; This warning is displayed once every 8 hours.</span>
<span class="co">#&gt; Call `lifecycle::last_warnings()` to see where this warning was generated.</span>
<span class="co">#&gt; $ptt</span>
<span class="co">#&gt; $ptt$Qmax</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Pettitt's test for single change-point detection</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  vl[vl_cmp]</span>
<span class="co">#&gt; U* = 768, p-value = 0.000508</span>
<span class="co">#&gt; alternative hypothesis: two.sided</span>
<span class="co">#&gt; sample estimates:</span>
<span class="co">#&gt; probable change point at time K </span>
<span class="co">#&gt;                              44 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $mkt</span>
<span class="co">#&gt; $mkt$Qmax</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Mann-Kendall trend test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  vl[vl_cmp]</span>
<span class="co">#&gt; z = -4.1079, n = 75, p-value = 3.993e-05</span>
<span class="co">#&gt; alternative hypothesis: true S is not equal to 0</span>
<span class="co">#&gt; sample estimates:</span>
<span class="co">#&gt;             S          varS           tau </span>
<span class="co">#&gt;  -899.0000000 47787.6666667    -0.3241977 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $tst</span>
<span class="co">#&gt; $tst$Qmax</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Sen's slope</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  values</span>
<span class="co">#&gt; z = -4.1079, n = 75, p-value = 3.993e-05</span>
<span class="co">#&gt; alternative hypothesis: true z is not equal to 0</span>
<span class="co">#&gt; 95 percent confidence interval:</span>
<span class="co">#&gt;  -15.516129  -4.285714</span>
<span class="co">#&gt; sample estimates:</span>
<span class="co">#&gt; Sen's slope </span>
<span class="co">#&gt;   -9.285714 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $ts_fit</span>
<span class="co">#&gt; $ts_fit$Qmax</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; mblm::mblm(formula = eval(frml), dataframe = df.theil, repeated = FALSE)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt; (Intercept)        Year1  </span>
<span class="co">#&gt;   19013.714       -9.286  </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $tt</span>
<span class="co">#&gt; $tt$Qmax</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Welch Two Sample t-test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  d1 and d2</span>
<span class="co">#&gt; t = 4.1012, df = 70.533, p-value = 0.0001086</span>
<span class="co">#&gt; alternative hypothesis: true difference in means is not equal to 0</span>
<span class="co">#&gt; 95 percent confidence interval:</span>
<span class="co">#&gt;  270.2942 781.9355</span>
<span class="co">#&gt; sample estimates:</span>
<span class="co">#&gt; mean of x mean of y </span>
<span class="co">#&gt; 1104.3023  578.1875 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $ft</span>
<span class="co">#&gt; $ft$Qmax</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  F test to compare two variances</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  d1 and d2</span>
<span class="co">#&gt; F = 2.7011, num df = 42, denom df = 31, p-value = 0.004993</span>
<span class="co">#&gt; alternative hypothesis: true ratio of variances is not equal to 1</span>
<span class="co">#&gt; 95 percent confidence interval:</span>
<span class="co">#&gt;  1.362952 5.175132</span>
<span class="co">#&gt; sample estimates:</span>
<span class="co">#&gt; ratio of variances </span>
<span class="co">#&gt;           2.701111 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $year</span>
<span class="co">#&gt; Qmax </span>
<span class="co">#&gt; 1981 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $maxval</span>
<span class="co">#&gt; $maxval$Qmax</span>
<span class="co">#&gt; [1] 2790</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $fixed_year</span>
<span class="co">#&gt; [1] FALSE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $pvalues</span>
<span class="co">#&gt;   N                                            Variable Change.Year    Trend</span>
<span class="co">#&gt; 1 1 Maximum annual discharge during seasonal flood wave        1981 -9.28571</span>
<span class="co">#&gt;         M1       M2 MeanRatio      sd1      sd2 sdRatio Mann.Kendall Pettitt</span>
<span class="co">#&gt; 1 1104.302 578.1875     -47.6 687.4269 418.2687   -39.2        4e-05 0.00051</span>
<span class="co">#&gt;   Student  Fisher</span>
<span class="co">#&gt; 1 0.00011 0.00499</span></pre></body></html></div>
<p>This is an example with three variables selected:</p>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="no">tests</span> <span class="kw">=</span> <span class="kw pkg">grwat</span><span class="kw ns">::</span><span class="fu"><a href="../reference/test_variables.html">test_variables</a></span>(<span class="no">df</span>, <span class="no">Qygr</span>, <span class="no">date10w1</span>, <span class="no">Wpol3</span>)
<span class="no">tests</span>$<span class="no">pvalues</span>
<span class="co">#&gt;   N                                                              Variable</span>
<span class="co">#&gt; 1 1 Annual groundwater discharge ("baseflow") during water-resources year</span>
<span class="co">#&gt; 2 2                   First date of 10-day window discharge during winter</span>
<span class="co">#&gt; 3 3                Seasonal flood runoff (with groundwater and rainwater)</span>
<span class="co">#&gt;   Change.Year    Trend       M1       M2 MeanRatio      sd1      sd2 sdRatio</span>
<span class="co">#&gt; 1        1975  0.56385 27.17243 51.91974      91.1  5.45524 16.05091   194.2</span>
<span class="co">#&gt; 2        1971 -0.27660   30-Dec   02-Dec     -28.0 39.00000 59.00000    51.3</span>
<span class="co">#&gt; 3        1981 -0.02026  2.92196  1.84939     -36.7  1.64315  1.02748   -37.5</span>
<span class="co">#&gt;   Mann.Kendall Pettitt Student  Fisher</span>
<span class="co">#&gt; 1      0.00000 0.00000 0.00000 0.00000</span>
<span class="co">#&gt; 2      0.27215 0.21652 0.01556 0.01852</span>
<span class="co">#&gt; 3      0.00246 0.01007 0.00090 0.00780</span></pre></body></html></div>
<p>If you want to test all parameters, just skip variable names:</p>
<div class="sourceCode" id="cb13"><html><body><pre class="r"><span class="no">tests</span> <span class="kw">=</span> <span class="kw pkg">grwat</span><span class="kw ns">::</span><span class="fu"><a href="../reference/test_variables.html">test_variables</a></span>(<span class="no">df</span>)
<span class="no">tests</span>$<span class="no">change_year</span>
<span class="co">#&gt; NULL</span></pre></body></html></div>
<p>Long-term changes are tested against breaking year, which is calculated for each variable using Pettitt test. However, if you want to use a fixed year, you should pass the desired breaking year into <code>change_year</code> parameter:</p>
<div class="sourceCode" id="cb14"><html><body><pre class="r"><span class="no">tests</span> <span class="kw">=</span> <span class="kw pkg">grwat</span><span class="kw ns">::</span><span class="fu"><a href="../reference/test_variables.html">test_variables</a></span>(<span class="no">df</span>, <span class="no">Qmax</span>, <span class="no">Qygr</span>, <span class="kw">change_year</span> <span class="kw">=</span> <span class="fl">1987</span>)
<span class="no">tests</span>$<span class="no">ft</span> <span class="co"># Fisher F tests to compare two variances</span>
<span class="co">#&gt; $Qmax</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  F test to compare two variances</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  d1 and d2</span>
<span class="co">#&gt; F = 2.7011, num df = 42, denom df = 31, p-value = 0.004993</span>
<span class="co">#&gt; alternative hypothesis: true ratio of variances is not equal to 1</span>
<span class="co">#&gt; 95 percent confidence interval:</span>
<span class="co">#&gt;  1.362952 5.175132</span>
<span class="co">#&gt; sample estimates:</span>
<span class="co">#&gt; ratio of variances </span>
<span class="co">#&gt;           2.701111 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $Qygr</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  F test to compare two variances</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  d1 and d2</span>
<span class="co">#&gt; F = 0.11551, num df = 36, denom df = 37, p-value = 2.678e-09</span>
<span class="co">#&gt; alternative hypothesis: true ratio of variances is not equal to 1</span>
<span class="co">#&gt; 95 percent confidence interval:</span>
<span class="co">#&gt;  0.0598440 0.2236352</span>
<span class="co">#&gt; sample estimates:</span>
<span class="co">#&gt; ratio of variances </span>
<span class="co">#&gt;          0.1155124</span></pre></body></html></div>
</div>
<div id="plot-interannual-changes" class="section level2">
<h2 class="hasAnchor">
<a href="#plot-interannual-changes" class="anchor"></a>Plot interannual changes</h2>
<p>Interannual changes are visualized using <code><a href="../reference/plot_variables.html">plot_variables()</a></code> function. Its syntax is similar to <code><a href="../reference/test_variables.html">test_variables()</a></code> and <code><a href="../reference/plot_separation.html">plot_separation()</a></code>:</p>
<div class="sourceCode" id="cb15"><html><body><pre class="r"><span class="kw pkg">grwat</span><span class="kw ns">::</span><span class="fu"><a href="../reference/plot_variables.html">plot_variables</a></span>(<span class="no">df</span>, <span class="no">Qmax</span>) <span class="co"># plot one selected variable</span></pre></body></html></div>
<p><img src="grwat_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<div class="sourceCode" id="cb16"><html><body><pre class="r"><span class="kw pkg">grwat</span><span class="kw ns">::</span><span class="fu"><a href="../reference/plot_variables.html">plot_variables</a></span>(<span class="no">df</span>, <span class="no">date10w1</span>, <span class="no">Wpol3</span>) <span class="co"># plot two variables sequentially</span></pre></body></html></div>
<p><img src="grwat_files/figure-html/unnamed-chunk-14-2.png" width="700"><img src="grwat_files/figure-html/unnamed-chunk-14-3.png" width="700"></p>
<div class="sourceCode" id="cb17"><html><body><pre class="r"><span class="kw pkg">grwat</span><span class="kw ns">::</span><span class="fu"><a href="../reference/plot_variables.html">plot_variables</a></span>(<span class="no">df</span>, <span class="no">Qmax</span>, <span class="no">Qygr</span>, <span class="no">date10w1</span>, <span class="no">Wpol3</span>, <span class="co"># plot four variables in matrix layout</span>
                      <span class="kw">layout</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span>), <span class="kw">nrow</span><span class="kw">=</span><span class="fl">2</span>, <span class="kw">byrow</span><span class="kw">=</span><span class="fl">TRUE</span>))</pre></body></html></div>
<p><img src="grwat_files/figure-html/unnamed-chunk-14-4.png" width="700"></p>
<p>You can add the results of statistical tests to the plot by specifying the result of <code><a href="../reference/test_variables.html">test_variables()</a></code> function to the <code>tests</code> parameter. In that case the subtitle with test results will be added, Theil-Sen slope and Pettitt test breaking year are drawn as solid (<span class="math inline">\(p \leq 0.05\)</span>) or dashed (<span class="math inline">\(p &gt; 0.05\)</span>) lines:</p>
<div class="sourceCode" id="cb18"><html><body><pre class="r"><span class="kw pkg">grwat</span><span class="kw ns">::</span><span class="fu"><a href="../reference/plot_variables.html">plot_variables</a></span>(<span class="no">df</span>, <span class="no">date10w1</span>, <span class="no">Wpol3</span>, <span class="no">DaysThawWin</span>, <span class="no">Qmaxpavs</span>,
                      <span class="kw">tests</span> <span class="kw">=</span> <span class="fu"><a href="../reference/test_variables.html">test_variables</a></span>(<span class="no">df</span>, <span class="no">date10w1</span>, <span class="no">Wpol3</span>, <span class="no">DaysThawWin</span>, <span class="no">Qmaxpavs</span>)) <span class="co"># add test information</span></pre></body></html></div>
<p><img src="grwat_files/figure-html/unnamed-chunk-15-1.png" width="700"><img src="grwat_files/figure-html/unnamed-chunk-15-2.png" width="700"><img src="grwat_files/figure-html/unnamed-chunk-15-3.png" width="700"><img src="grwat_files/figure-html/unnamed-chunk-15-4.png" width="700"></p>
<blockquote>
<p>Note that <code>tests</code> parameter of <code><a href="../reference/plot_variables.html">plot_variables()</a></code> expects the tests for the same variables as those selected for plotting. If you plot variables A, B, C and supply tests for variables X, Y, Z, they will be added without any warnings, and it is your responsibility to keep them in correspondence with each other</p>
</blockquote>
<p>Finally, you can plot all variables by not supplying column names to <code><a href="../reference/plot_variables.html">plot_variables()</a></code> function. In that case tests (if you want to plot them too) should also be calculated for all variables:</p>
<div class="sourceCode" id="cb19"><html><body><pre class="r"><span class="kw pkg">grwat</span><span class="kw ns">::</span><span class="fu"><a href="../reference/plot_variables.html">plot_variables</a></span>(<span class="no">df</span>, <span class="kw">tests</span> <span class="kw">=</span> <span class="fu"><a href="../reference/test_variables.html">test_variables</a></span>(<span class="no">df</span>))</pre></body></html></div>
</div>
<div id="plot-long-term-period-changes" class="section level2">
<h2 class="hasAnchor">
<a href="#plot-long-term-period-changes" class="anchor"></a>Plot long-term period changes</h2>
<p>Long-term changes are the differences between summarized statistics of one variable calculated for two selected periods. Because these statistics reflect the differences in distributions of parameters, grwat visualizes them as box plots using <code><a href="../reference/plot_periods.html">plot_periods()</a></code> function. The syntax is similar to <code><a href="../reference/plot_variables.html">plot_variables()</a></code> except that you must provide either <code>tests</code> or <code>year</code> parameter. If both are supplied then <code>tests</code> is prioritized (you can also supply a fixed year when testing variables:</p>
<div class="sourceCode" id="cb20"><html><body><pre class="r"><span class="kw pkg">grwat</span><span class="kw ns">::</span><span class="fu"><a href="../reference/plot_periods.html">plot_periods</a></span>(<span class="no">df</span>, <span class="no">Qy</span>, <span class="kw">year</span> <span class="kw">=</span> <span class="fl">1978</span>)</pre></body></html></div>
<p><img src="grwat_files/figure-html/unnamed-chunk-17-1.png" width="700"></p>
<div class="sourceCode" id="cb21"><html><body><pre class="r"><span class="kw pkg">grwat</span><span class="kw ns">::</span><span class="fu"><a href="../reference/plot_periods.html">plot_periods</a></span>(<span class="no">df</span>, <span class="no">Qy</span>, <span class="kw">tests</span> <span class="kw">=</span> <span class="fu"><a href="../reference/test_variables.html">test_variables</a></span>(<span class="no">df</span>, <span class="no">Qy</span>))</pre></body></html></div>
<p><img src="grwat_files/figure-html/unnamed-chunk-17-2.png" width="700"></p>
<p>Multiple plots can be combined on one page using <code>layout</code> parameter:</p>
<div class="sourceCode" id="cb22"><html><body><pre class="r"><span class="kw pkg">grwat</span><span class="kw ns">::</span><span class="fu"><a href="../reference/plot_periods.html">plot_periods</a></span>(<span class="no">df</span>, <span class="no">Qy</span>, <span class="no">Qmax</span>,
                    <span class="kw">tests</span> <span class="kw">=</span> <span class="fu"><a href="../reference/test_variables.html">test_variables</a></span>(<span class="no">df</span>, <span class="no">Qy</span>, <span class="no">Qmax</span>),
                    <span class="kw">layout</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">2</span>)))</pre></body></html></div>
<p><img src="grwat_files/figure-html/unnamed-chunk-18-1.png" width="700"></p>
<p>To plot long-term changes for all variables just skip variable names in function call:</p>
<div class="sourceCode" id="cb23"><html><body><pre class="r"><span class="kw pkg">grwat</span><span class="kw ns">::</span><span class="fu"><a href="../reference/plot_periods.html">plot_periods</a></span>(<span class="no">df</span>, <span class="kw">tests</span> <span class="kw">=</span> <span class="fu"><a href="../reference/test_variables.html">test_variables</a></span>(<span class="no">df</span>))</pre></body></html></div>
<p>There is also a small helper function that plots a histogram of minimal discharge month for summer and winter periods:</p>
<div class="sourceCode" id="cb24"><html><body><pre class="r"><span class="kw pkg">grwat</span><span class="kw ns">::</span><span class="fu"><a href="../reference/plot_minmonth.html">plot_minmonth</a></span>(<span class="no">df</span>, <span class="kw">year</span> <span class="kw">=</span> <span class="fl">1978</span>)</pre></body></html></div>
<p><img src="grwat_files/figure-html/unnamed-chunk-20-1.png" width="700"></p>
</div>
</div>
<div id="report" class="section level1">
<h1 class="hasAnchor">
<a href="#report" class="anchor"></a>Report</h1>
<p>The final feature of grwat package is reporting. Previous sections demonstrated various functions that allow different level of data processing: from individual tables, plots and maps to fully processed folders, tests and plots of multiple variables. Reporting allows you to produce a <strong>single PDF file</strong> that provides a comprehensive overview of hydrograph separation and water discharge variables for the whole time period covered by your data. There are currently two functions that work with folder data:</p>
<ul>
<li>
<code><a href="../reference/report_gauge.html">report_gauge()</a></code> generates a report for a gauge folder containing <em>separation file</em> <code>AllGrWat.txt</code>, <em>variables file</em> <code>Total.txt</code> and map file <code>*.png</code>.</li>
<li>
<code><a href="../reference/report_basins.html">report_basins()</a></code> generates multiple reports for the hierarchy of basin and gauge folders. It actually runs <code><a href="../reference/report_gauge.html">report_gauge()</a></code> for every leaf subdirectory in the provided path.</li>
</ul>
<p>The syntax of these functions is straightforward:</p>
<div class="sourceCode" id="cb25"><html><body><pre class="r"><span class="kw pkg">grwat</span><span class="kw ns">::</span><span class="fu"><a href="../reference/report_gauge.html">report_gauge</a></span>(<span class="st">"/Volumes/Work/_grwat/2018/out/1_Sever/Mezen_Malonisog"</span>)
<span class="kw pkg">grwat</span><span class="kw ns">::</span><span class="fu"><a href="../reference/report_basins.html">report_basins</a></span>(<span class="st">"/Volumes/Work/_grwat/2018/out/"</span>)</pre></body></html></div>
<p>As a result of reporting each gauge folder gains <em>report.pdf</em> (report) and <em>pvalues<gaugename>.xlsx</gaugename></em> (p-values of statistical tests) files:</p>
<p><img src="report_folder.png"></p>
<p>A report file contains 5 sections:</p>
<ol style="list-style-type: decimal">
<li>Input data</li>
<li>Hydrograph separation</li>
<li>Interannual changes</li>
<li>Long-term changes</li>
<li>Statistical tests</li>
</ol>
<p>They are organized in a compact form with multiple plots per page:</p>
<p><img src="report.png"></p>
<blockquote>
<p>Note that reporting is a time-consuming operation since it produces dozens of high-quality plots. Therefore it is reasonable to run reporting functions from a separate R session if you want to perform another tasks in R at the same time. Or take a cup of coffee and watch your favourite TV series.</p>
</blockquote>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p>In the next release of grwat package separation stage will be rewritten in C++ using Rcpp package to provide the complete workflow inside R ecosystem<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Timofey Samsonov, Ekaterina Retz, Maria Kireeva.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
